<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoodFlow - Food Delivery System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- QR Code Scanner Library -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Micro-animations */
        .cart-bounce {
            animation: cartBounce 0.6s ease-out;
        }
        
        @keyframes cartBounce {
            0% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(0.95); }
            75% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .item-add-animation {
            animation: itemAdd 0.8s ease-out;
        }
        
        @keyframes itemAdd {
            0% { 
                transform: scale(1) rotate(0deg);
                background: linear-gradient(45deg, #10b981, #059669);
            }
            25% { 
                transform: scale(1.1) rotate(5deg);
                background: linear-gradient(45deg, #34d399, #10b981);
            }
            50% { 
                transform: scale(0.95) rotate(-3deg);
                background: linear-gradient(45deg, #6ee7b7, #34d399);
            }
            75% { 
                transform: scale(1.05) rotate(2deg);
                background: linear-gradient(45deg, #34d399, #10b981);
            }
            100% { 
                transform: scale(1) rotate(0deg);
                background: linear-gradient(45deg, #10b981, #059669);
            }
        }
        
        .quantity-change {
            animation: quantityPulse 0.4s ease-out;
        }
        
        @keyframes quantityPulse {
            0% { transform: scale(1); color: inherit; }
            50% { transform: scale(1.3); color: #10b981; font-weight: bold; }
            100% { transform: scale(1); color: inherit; }
        }
        
        .status-transition {
            animation: statusChange 0.8s ease-out;
        }
        
        @keyframes statusChange {
            0% { 
                transform: scale(1) translateY(0);
                box-shadow: 0 0 0 rgba(59, 130, 246, 0);
            }
            25% { 
                transform: scale(1.05) translateY(-2px);
                box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
            }
            50% { 
                transform: scale(0.98) translateY(1px);
                box-shadow: 0 2px 10px rgba(59, 130, 246, 0.2);
            }
            75% { 
                transform: scale(1.02) translateY(-1px);
                box-shadow: 0 6px 25px rgba(59, 130, 246, 0.4);
            }
            100% { 
                transform: scale(1) translateY(0);
                box-shadow: 0 0 0 rgba(59, 130, 246, 0);
            }
        }
        
        .delivery-truck {
            animation: deliveryMove 3s ease-in-out infinite;
        }
        
        @keyframes deliveryMove {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(10px) rotate(1deg); }
            50% { transform: translateX(20px) rotate(0deg); }
            75% { transform: translateX(10px) rotate(-1deg); }
        }
        
        .delivery-rider-moving {
            animation: riderMovement 8s linear infinite;
            transform-origin: center;
        }
        
        @keyframes riderMovement {
            0% { 
                transform: translate(30px, 90px) rotate(0deg);
            }
            25% { 
                transform: translate(120px, 90px) rotate(0deg);
            }
            37.5% { 
                transform: translate(120px, 60px) rotate(-90deg);
            }
            50% { 
                transform: translate(200px, 60px) rotate(0deg);
            }
            62.5% { 
                transform: translate(200px, 90px) rotate(90deg);
            }
            75% { 
                transform: translate(280px, 90px) rotate(0deg);
            }
            87.5% { 
                transform: translate(280px, 120px) rotate(90deg);
            }
            100% { 
                transform: translate(370px, 120px) rotate(0deg);
            }
        }
        
        .rider-glow {
            animation: riderGlow 2s ease-in-out infinite;
        }
        
        @keyframes riderGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 5px rgba(245, 158, 11, 0.6));
            }
            50% { 
                filter: drop-shadow(0 0 15px rgba(245, 158, 11, 0.9));
            }
        }
        
        .delivery-path-main {
            stroke-dasharray: 400;
            stroke-dashoffset: 400;
            animation: drawDeliveryPath 8s linear infinite;
        }
        
        @keyframes drawDeliveryPath {
            0% { stroke-dashoffset: 400; }
            100% { stroke-dashoffset: 0; }
        }
        
        .timeline-step {
            transition: all 0.5s ease;
        }
        
        .timeline-step.active {
            animation: stepPulse 1s ease-in-out;
        }
        
        @keyframes stepPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .timeline-step.completed {
            animation: stepComplete 0.8s ease-out;
        }
        
        @keyframes stepComplete {
            0% { 
                transform: scale(1);
                background: #e5e7eb;
            }
            50% { 
                transform: scale(1.3);
                background: #10b981;
            }
            100% { 
                transform: scale(1);
                background: #10b981;
            }
        }
        
        .progress-fill {
            animation: progressGrow 2s ease-out;
        }
        
        @keyframes progressGrow {
            from { width: 0%; }
            to { width: var(--progress-width); }
        }
        
        .floating-notification {
            animation: floatUp 0.6s ease-out;
        }
        
        @keyframes floatUp {
            0% { 
                transform: translateY(20px) scale(0.8);
                opacity: 0;
            }
            50% { 
                transform: translateY(-5px) scale(1.05);
                opacity: 0.8;
            }
            100% { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        .order-step-active {
            animation: stepActivate 0.8s ease-out;
        }
        
        @keyframes stepActivate {
            0% { 
                transform: scale(0.8);
                background: #e5e7eb;
                color: #6b7280;
            }
            50% { 
                transform: scale(1.2);
                background: #dbeafe;
                color: #3b82f6;
            }
            100% { 
                transform: scale(1);
                background: #dcfce7;
                color: #16a34a;
            }
        }
        
        .map-pulse {
            animation: mapPulse 2s ease-in-out infinite;
        }
        
        @keyframes mapPulse {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 0 20px rgba(59, 130, 246, 0);
                transform: scale(1.05);
            }
        }
        
        .delivery-path {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: drawPath 4s ease-in-out infinite;
        }
        
        @keyframes drawPath {
            0% { stroke-dashoffset: 200; }
            50% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: -200; }
        }
        
        .shake-animation {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .glow-pulse {
            animation: glowPulse 2s ease-in-out infinite;
        }
        
        @keyframes glowPulse {
            0%, 100% { 
                box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
            }
            50% { 
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.8), 0 0 30px rgba(59, 130, 246, 0.4);
            }
        }
        
        /* Offers Carousel Styles */
        .offer-card {
            min-width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 2rem;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .offer-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: offerShine 3s ease-in-out infinite;
        }
        
        @keyframes offerShine {
            0%, 100% { transform: rotate(0deg) scale(1); opacity: 0.3; }
            50% { transform: rotate(180deg) scale(1.1); opacity: 0.1; }
        }
        
        .carousel-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .carousel-indicator.active {
            background: white;
            transform: scale(1.2);
        }
        
        /* QR Code Animations */
        @keyframes scanLine {
            0% { top: 1rem; opacity: 1; }
            50% { opacity: 0.5; }
            100% { top: calc(100% - 2rem); opacity: 1; }
        }
        
        .qr-code-pattern {
            background-image: 
                linear-gradient(45deg, #000 25%, transparent 25%), 
                linear-gradient(-45deg, #000 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #000 75%), 
                linear-gradient(-45deg, transparent 75%, #000 75%);
            background-size: 4px 4px;
            background-position: 0 0, 0 2px, 2px -2px, -2px 0px;
        }
        
        /* Enhanced Live Tracking Styles */
        .delivery-pulse {
            animation: deliveryPulse 2s ease-in-out infinite;
        }
        
        @keyframes deliveryPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }
        }
        
        .route-animation {
            stroke-dasharray: 300;
            stroke-dashoffset: 300;
            animation: drawRoute 8s linear infinite;
        }
        
        @keyframes drawRoute {
            0% { stroke-dashoffset: 300; }
            100% { stroke-dashoffset: 0; }
        }
        
        .delivery-vehicle {
            animation: vehicleMove 10s linear infinite;
        }
        
        @keyframes vehicleMove {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            25% { transform: translateX(100px) translateY(-20px) rotate(15deg); }
            50% { transform: translateX(200px) translateY(0) rotate(0deg); }
            75% { transform: translateX(300px) translateY(20px) rotate(-15deg); }
            100% { transform: translateX(400px) translateY(0) rotate(0deg); }
        }
        
        /* Modern Card Layouts */
        .menu-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
            position: relative;
        }
        
        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #f5576c);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .menu-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }
        
        .menu-card:hover::before {
            opacity: 1;
        }
        
        .menu-card-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
            overflow: hidden;
        }
        
        .menu-card-image::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.1) 100%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .menu-card:hover .menu-card-image::after {
            transform: translateX(100%);
        }
        
        .restaurant-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
            position: relative;
        }
        
        .restaurant-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .restaurant-card:hover {
            transform: translateY(-12px) scale(1.03);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
        }
        
        .restaurant-card:hover::before {
            opacity: 1;
        }
        
        /* Glassmorphism Effects */
        .glass-nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .glass-modal {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .glass-sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            border-left: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        /* Neumorphism Effects */
        .neuro-card {
            background: linear-gradient(145deg, #f0f0f0, #cacaca);
            box-shadow: 20px 20px 60px #bebebe, -20px -20px 60px #ffffff;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .neuro-card:hover {
            box-shadow: inset 20px 20px 60px #bebebe, inset -20px -20px 60px #ffffff;
        }
        
        .neuro-button {
            background: linear-gradient(145deg, #667eea, #764ba2);
            box-shadow: 8px 8px 16px rgba(102, 126, 234, 0.3), -8px -8px 16px rgba(118, 75, 162, 0.3);
            border: none;
            border-radius: 12px;
            transition: all 0.2s ease;
        }
        
        .neuro-button:hover {
            box-shadow: inset 8px 8px 16px rgba(102, 126, 234, 0.3), inset -8px -8px 16px rgba(118, 75, 162, 0.3);
        }
        
        /* Checkout Stepper */
        .stepper {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
        }
        
        .stepper-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            flex: 1;
            max-width: 200px;
        }
        
        .stepper-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 60%;
            right: -40%;
            height: 2px;
            background: #e5e7eb;
            z-index: 1;
        }
        
        .stepper-step.active:not(:last-child)::after,
        .stepper-step.completed:not(:last-child)::after {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .stepper-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e5e7eb;
            color: #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }
        
        .stepper-step.active .stepper-circle {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
            animation: pulse 2s infinite;
        }
        
        .stepper-step.completed .stepper-circle {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .stepper-label {
            margin-top: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            text-align: center;
        }
        
        .stepper-step.active .stepper-label {
            color: #3b82f6;
            font-weight: 600;
        }
        
        .stepper-step.completed .stepper-label {
            color: #10b981;
            font-weight: 600;
        }
        
        /* Rating Stars */
        .rating-stars {
            display: flex;
            gap: 2px;
        }
        
        .rating-star {
            color: #fbbf24;
            font-size: 1rem;
        }
        
        .rating-star.empty {
            color: #d1d5db;
        }
        
        /* Price Badge */
        .price-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        
        /* Add to Cart Button Animation */
        .add-to-cart-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }
        
        .add-to-cart-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, #764ba2, #667eea);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .add-to-cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .add-to-cart-btn:hover::before {
            opacity: 1;
        }
        
        .add-to-cart-btn span {
            position: relative;
            z-index: 1;
        }
        
        /* Custom SVG Animations */
        .svg-float {
            animation: svgFloat 6s ease-in-out infinite;
        }
        
        @keyframes svgFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(1deg); }
            50% { transform: translateY(-5px) rotate(0deg); }
            75% { transform: translateY(-15px) rotate(-1deg); }
        }
        
        .svg-bounce {
            animation: svgBounce 2s ease-in-out infinite;
        }
        
        @keyframes svgBounce {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-20px) scale(1.05); }
        }
        
        @keyframes fadeOut {
            from { 
                opacity: 1;
                transform: translateX(0);
            }
            to { 
                opacity: 0;
                transform: translateX(100%);
            }
        }
        
        /* Dark mode styles */
        .dark {
            color-scheme: dark;
        }
        
        .dark body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e2e8f0;
        }
        
        .dark .gradient-bg {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
        }
        
        .dark .bg-white {
            background-color: #2d3748 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .text-gray-600 {
            color: #a0aec0 !important;
        }
        
        .dark .text-gray-700 {
            color: #cbd5e0 !important;
        }
        
        .dark .text-gray-800 {
            color: #e2e8f0 !important;
        }
        
        .dark .text-gray-500 {
            color: #9ca3af !important;
        }
        
        .dark .border {
            border-color: #4a5568 !important;
        }
        
        .dark .border-t {
            border-color: #4a5568 !important;
        }
        
        .dark .border-b {
            border-color: #4a5568 !important;
        }
        
        .dark .bg-gray-50 {
            background-color: #374151 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .bg-gray-100 {
            background-color: #4b5563 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .bg-gray-200 {
            background-color: #6b7280 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .hover\:bg-gray-100:hover {
            background-color: #4b5563 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .hover\:bg-gray-300:hover {
            background-color: #6b7280 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .hover\:bg-gray-50:hover {
            background-color: #4b5563 !important;
            color: #e2e8f0 !important;
        }
        
        .dark .card-hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
        }
        
        .dark .card-hover:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
        }
        
        .dark .shadow-md {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2) !important;
        }
        
        .dark .shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2) !important;
        }
        
        .dark .shadow-xl {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2) !important;
        }
        
        .dark input, .dark textarea, .dark select {
            background-color: #374151 !important;
            border-color: #4b5563 !important;
            color: #e2e8f0 !important;
        }
        
        .dark input:focus, .dark textarea:focus, .dark select:focus {
            border-color: #60a5fa !important;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1) !important;
        }
        
        .dark input::placeholder, .dark textarea::placeholder {
            color: #9ca3af !important;
        }
        
        /* Dark mode navigation */
        .dark .glass-nav {
            color: #e2e8f0 !important;
            background: rgba(45, 55, 72, 0.8) !important;
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(75, 85, 99, 0.3) !important;
        }
        
        .dark .glass-nav button:hover {
            color: #60a5fa !important;
            background-color: rgba(55, 65, 81, 0.8) !important;
        }
        
        /* Dark mode cards and containers */
        .dark .menu-card {
            background: rgba(45, 55, 72, 0.95) !important;
            border: 1px solid rgba(75, 85, 99, 0.3) !important;
            color: #e2e8f0 !important;
        }
        
        .dark .restaurant-card {
            background: rgba(45, 55, 72, 0.9) !important;
            border: 1px solid rgba(75, 85, 99, 0.3) !important;
            color: #e2e8f0 !important;
        }
        
        .dark .glass-card {
            background: rgba(45, 55, 72, 0.9) !important;
            border: 1px solid rgba(75, 85, 99, 0.2) !important;
            color: #e2e8f0 !important;
        }
        
        .dark .glass-modal {
            background: rgba(45, 55, 72, 0.95) !important;
            border: 1px solid rgba(75, 85, 99, 0.3) !important;
            color: #e2e8f0 !important;
        }
        
        .dark .glass-sidebar {
            background: rgba(45, 55, 72, 0.95) !important;
            border-left: 1px solid rgba(75, 85, 99, 0.3) !important;
            color: #e2e8f0 !important;
        }
        
        /* Dark mode text colors for specific elements */
        .dark h1, .dark h2, .dark h3, .dark h4, .dark h5, .dark h6 {
            color: #f7fafc !important;
        }
        
        .dark .font-bold, .dark .font-semibold {
            color: #f7fafc !important;
        }
        
        .dark .price-badge {
            background: linear-gradient(135deg, #10b981, #059669) !important;
            color: white !important;
        }
        
        /* Dark mode for notifications and dropdowns */
        .dark #notificationsDropdown {
            background-color: #2d3748 !important;
            border-color: #4a5568 !important;
            color: #e2e8f0 !important;
        }
        
        .dark #userMenu {
            background-color: #2d3748 !important;
            border-color: #4a5568 !important;
            color: #e2e8f0 !important;
        }
        
        .dark #searchSuggestions {
            background-color: #2d3748 !important;
            border-color: #4a5568 !important;
            color: #e2e8f0 !important;
        }
        
        /* Dark mode for stepper and progress elements */
        .dark .stepper-label {
            color: #a0aec0 !important;
        }
        
        .dark .stepper-step.active .stepper-label {
            color: #60a5fa !important;
        }
        
        .dark .stepper-step.completed .stepper-label {
            color: #34d399 !important;
        }
        
        /* Dark mode for form elements and buttons */
        .dark button {
            color: inherit;
        }
        
        .dark .bg-blue-600 {
            background-color: #3b82f6 !important;
            color: white !important;
        }
        
        .dark .bg-green-600 {
            background-color: #10b981 !important;
            color: white !important;
        }
        
        .dark .bg-red-600 {
            background-color: #ef4444 !important;
            color: white !important;
        }
        
        .dark .bg-yellow-600 {
            background-color: #f59e0b !important;
            color: white !important;
        }
        
        /* Dark mode for specific text elements */
        .dark .text-center {
            color: #e2e8f0 !important;
        }
        
        .dark label {
            color: #e2e8f0 !important;
        }
        
        .dark .divide-y > * {
            border-color: #4a5568 !important;
        }
        
        .theme-transition {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 min-h-screen theme-transition">
    <!-- Real-time Notifications Container -->
    <div id="notificationContainer" class="fixed top-20 right-4 z-50 space-y-2 max-w-sm">
        <!-- Real-time notifications will appear here -->
    </div>

    <!-- Navigation -->
<nav class="glass-nav text-gray-800 shadow-lg sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <div class="flex items-center space-x-4">
                <!-- Updated Logo -->
                <div class="text-2xl font-bold">Salsa & Spice</div>
            </div>
            <div class="hidden md:flex items-center space-x-6">
                <button onclick="showSection('home')" class="hover:text-blue-600 transition-colors font-medium">Home</button>
                <button onclick="showSection('restaurants')" class="hover:text-blue-600 transition-colors font-medium">Restaurants</button>
                <button onclick="showSection('orders')" class="hover:text-blue-600 transition-colors font-medium">My Orders</button>
                <button onclick="showSection('profile')" class="hover:text-blue-600 transition-colors font-medium">Profile</button>
            </div>
            
            <!-- Mobile Menu Button -->
            <button onclick="toggleMobileMenu()" class="md:hidden mobile-nav-btn hover:bg-gray-100 hover:bg-opacity-80 rounded-lg transition-colors" id="mobileMenuBtn">
                <span class="text-xl">‚ò∞</span>
            </button>
            <div class="flex items-center space-x-2 md:space-x-4">
                
                <!-- Notifications Bell (Updated Icon) -->
                <div class="relative">
                    <button onclick="toggleNotifications()" class="mobile-nav-btn hover:bg-gray-100 hover:bg-opacity-80 rounded-lg transition-colors">
                        üõéÔ∏è <span id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                    </button>
                    <!-- Notifications Dropdown -->
                    <div id="notificationsDropdown" class="hidden absolute right-0 top-full mt-2 w-80 md:w-80 w-screen max-w-sm bg-white rounded-lg shadow-xl border z-50 max-h-96 overflow-y-auto">
                        <div class="p-4 border-b">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-800">Notifications</h3>
                                <button onclick="clearAllNotifications()" class="text-sm text-blue-600 hover:text-blue-800">Clear All</button>
                            </div>
                        </div>
                        <div id="notificationsList" class="divide-y">
                            <div class="p-4 text-center text-gray-500">No new notifications</div>
                        </div>
                    </div>
                </div>
                
                <!-- Dark Mode Toggle (Updated Icons) -->
                <button onclick="toggleDarkMode()" class="mobile-nav-btn hover:bg-gray-100 hover:bg-opacity-80 rounded-lg transition-all duration-300" id="darkModeToggle">
                    <div class="w-6 h-6 relative">
                        <span class="absolute inset-0 transition-all duration-300" id="lightIcon">üåû</span>
                        <span class="absolute inset-0 transition-all duration-300 opacity-0 rotate-180" id="darkIcon">üåö</span>
                    </div>
                </button>

                <!-- Cart -->
                <div class="relative">
                    <button onclick="toggleCart()" class="mobile-nav-btn hover:bg-gray-100 hover:bg-opacity-80 rounded-lg transition-colors">
                        üõí <span id="cartCount" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </button>
                </div>

                <!-- User Menu -->
                <button onclick="toggleUserMenu()" class="flex items-center space-x-2 hover:bg-gray-100 hover:bg-opacity-80 px-2 md:px-3 py-2 rounded-lg transition-colors">
                    <div class="w-8 h-8 bg-gray-200 bg-opacity-60 rounded-full flex items-center justify-center">üë§</div>
                    <span id="userName" class="font-medium hidden sm:inline">Guest</span>
                </button>
            </div>
        </div>
    </div>
</nav>

    <!-- Mobile Bottom Navigation -->
    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-40 safe-area-bottom">
        <div class="flex justify-around items-center py-2">
            <button onclick="showSection('home')" class="flex flex-col items-center py-2 px-3 text-xs transition-colors" id="mobileHome">
                <span class="text-xl mb-1">üè†</span>
                <span>Home</span>
            </button>
            <button onclick="showSection('restaurants')" class="flex flex-col items-center py-2 px-3 text-xs transition-colors" id="mobileRestaurants">
                <span class="text-xl mb-1">üçΩÔ∏è</span>
                <span>Restaurants</span>
            </button>
            <button onclick="showSection('orders')" class="flex flex-col items-center py-2 px-3 text-xs transition-colors" id="mobileOrders">
                <span class="text-xl mb-1">üìã</span>
                <span>Orders</span>
            </button>
            <button onclick="showSection('profile')" class="flex flex-col items-center py-2 px-3 text-xs transition-colors" id="mobileProfile">
                <span class="text-xl mb-1">üë§</span>
                <span>Profile</span>
            </button>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="md:hidden fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="fixed top-0 left-0 right-0 bg-white shadow-lg">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-lg font-semibold">Menu</h3>
                <button onclick="toggleMobileMenu()" class="text-2xl">‚úï</button>
            </div>
            <div class="p-4 space-y-4">
                <button onclick="showSection('home'); toggleMobileMenu();" class="w-full text-left py-3 px-4 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-3">
                    <span class="text-xl">üè†</span>
                    <span>Home</span>
                </button>
                <button onclick="showSection('restaurants'); toggleMobileMenu();" class="w-full text-left py-3 px-4 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-3">
                    <span class="text-xl">üçΩÔ∏è</span>
                    <span>Restaurants</span>
                </button>
                <button onclick="showSection('orders'); toggleMobileMenu();" class="w-full text-left py-3 px-4 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-3">
                    <span class="text-xl">üìã</span>
                    <span>My Orders</span>
                </button>
                <button onclick="showSection('profile'); toggleMobileMenu();" class="w-full text-left py-3 px-4 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-3">
                    <span class="text-xl">üë§</span>
                    <span>Profile</span>
                </button>
                <hr class="my-4">
                <button onclick="showVendorPanel(); toggleMobileMenu();" class="w-full text-left py-3 px-4 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-3">
                    <span class="text-xl">üè™</span>
                    <span>Vendor Panel</span>
                </button>
                <button onclick="showAdminPanel(); toggleMobileMenu();" class="w-full text-left py-3 px-4 hover:bg-gray-100 rounded-lg transition-colors flex items-center gap-3">
                    <span class="text-xl">‚öôÔ∏è</span>
                    <span>Admin Panel</span>
                </button>
            </div>
        </div>
    </div>

    <!-- User Menu Dropdown -->
    <div id="userMenu" class="hidden absolute right-4 top-16 bg-white rounded-lg shadow-lg border z-50 w-48">
        <div class="py-2">
            <button onclick="showLoginModal()" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition-colors">Login</button>
            <button onclick="showVendorPanel()" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition-colors">Vendor Panel</button>
            <button onclick="showAdminPanel()" class="w-full text-left px-4 py-2 hover:bg-gray-100 transition-colors">Admin Panel</button>
            <hr class="my-2">
            <button onclick="logout()" class="w-full text-left px-4 py-2 hover:bg-gray-100 text-red-600 transition-colors">Logout</button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8 pb-20 md:pb-8">
        <!-- Home Section -->
        <section id="homeSection" class="space-y-8">
            <!-- Personalized Dashboard -->
            <div id="personalizedDashboard" class="hidden space-y-6">
                <!-- Welcome Banner with Gamification -->
                <div class="gradient-bg rounded-2xl p-6 text-white">
                    <div class="flex justify-between items-start">
                        <div>
                            <h2 class="text-2xl font-bold mb-2">Welcome back, <span id="dashboardUserName">John</span>! üëã</h2>
                            <p class="opacity-90">Ready for your next delicious meal?</p>
                        </div>
                        <div class="text-right">
                            <div class="bg-white bg-opacity-20 rounded-lg p-3">
                                <div class="text-sm opacity-80">Loyalty Points</div>
                                <div class="text-2xl font-bold" id="loyaltyPoints">1,250</div>
                                <div class="text-xs opacity-70">Next reward: 250 pts</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Loyalty Progress Bar -->
                    <div class="mt-4">
                        <div class="flex justify-between text-sm mb-2">
                            <span>Progress to next reward</span>
                            <span id="loyaltyProgress">83%</span>
                        </div>
                        <div class="bg-white bg-opacity-20 rounded-full h-3">
                            <div class="bg-gradient-to-r from-yellow-400 to-orange-500 h-3 rounded-full transition-all duration-1000" 
                                 id="loyaltyProgressBar" style="width: 83%"></div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions & Current Order -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Current Order Status -->
                    <div id="currentOrderWidget" class="bg-white rounded-xl p-6 shadow-md">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                            <span class="text-2xl">üö¥</span>
                            Current Order
                        </h3>
                        <div id="currentOrderContent">
                            <p class="text-gray-500 text-center py-4">No active orders</p>
                        </div>
                    </div>

                    <!-- Favorite Dishes -->
                    <div class="bg-white rounded-xl p-6 shadow-md">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                            <span class="text-2xl">‚ù§Ô∏è</span>
                            Your Favorites
                        </h3>
                        <div id="favoriteDishes" class="space-y-3">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- AI Recommendations -->
                    <div class="bg-white rounded-xl p-6 shadow-md">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                            <span class="text-2xl">ü§ñ</span>
                            Recommended for You
                        </h3>
                        <div id="aiRecommendations" class="space-y-3">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Recent Orders & Reorder -->
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg flex items-center gap-2">
                            <span class="text-2xl">üîÑ</span>
                            Quick Reorder
                        </h3>
                        <button onclick="showSection('orders')" class="text-blue-600 hover:text-blue-800 text-sm">View All</button>
                    </div>
                    <div id="quickReorderItems" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Smart Offers Carousel -->
            <div id="smartOffersSection" class="mb-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <span class="text-3xl">üè∑Ô∏è</span>
                        Best Offers Today
                    </h2>
                    <button onclick="showAllOffers()" class="text-blue-600 hover:text-blue-800 text-sm font-medium">View All</button>
                </div>
                
                <div class="relative overflow-hidden rounded-2xl">
                    <div id="offersCarousel" class="flex transition-transform duration-500 ease-in-out">
                        <!-- Populated by JavaScript -->
                    </div>
                    
                    <!-- Carousel Navigation -->
                    <button onclick="prevOffer()" class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full p-3 shadow-lg transition-all duration-300 hover:scale-110">
                        <span class="text-xl">‚Üê</span>
                    </button>
                    <button onclick="nextOffer()" class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-full p-3 shadow-lg transition-all duration-300 hover:scale-110">
                        <span class="text-xl">‚Üí</span>
                    </button>
                    
                    <!-- Carousel Indicators -->
                    <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2" id="carouselIndicators">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Hero Section (for guests) -->
            <div id="guestHero" class="gradient-bg rounded-2xl p-8 text-white text-center relative overflow-hidden">
                <!-- Custom SVG Illustration -->
                <div class="absolute top-4 right-4 opacity-20">
                    <svg class="w-32 h-32 svg-float" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Delivery person illustration -->
                        <circle cx="100" cy="80" r="25" fill="currentColor" opacity="0.3"/>
                        <rect x="85" y="105" width="30" height="40" rx="15" fill="currentColor" opacity="0.3"/>
                        <circle cx="75" cy="160" r="15" fill="currentColor" opacity="0.3"/>
                        <circle cx="125" cy="160" r="15" fill="currentColor" opacity="0.3"/>
                        <rect x="60" y="145" width="80" height="15" rx="7" fill="currentColor" opacity="0.3"/>
                        <!-- Food box -->
                        <rect x="110" y="90" width="25" height="20" rx="3" fill="currentColor" opacity="0.4"/>
                        <circle cx="122" cy="85" r="3" fill="currentColor" opacity="0.5"/>
                    </svg>
                </div>
                <div class="absolute bottom-4 left-4 opacity-20">
                    <svg class="w-24 h-24 svg-bounce" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Food items -->
                        <circle cx="30" cy="30" r="12" fill="currentColor" opacity="0.4"/>
                        <circle cx="70" cy="30" r="12" fill="currentColor" opacity="0.4"/>
                        <circle cx="30" cy="70" r="12" fill="currentColor" opacity="0.4"/>
                        <circle cx="70" cy="70" r="12" fill="currentColor" opacity="0.4"/>
                        <circle cx="50" cy="50" r="8" fill="currentColor" opacity="0.6"/>
                    </svg>
                </div>
                
                <div class="relative z-10">
                    <h1 class="text-4xl md:text-6xl font-bold mb-4">Delicious Food Delivered</h1>
                    <p class="text-xl mb-8 opacity-90">Order from your favorite restaurants and track your delivery in real-time</p>
                    <div class="flex flex-col md:flex-row gap-4 max-w-md mx-auto">
                        <input type="text" placeholder="Enter your location" class="flex-1 px-4 py-3 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-300">
                        <button onclick="showSection('restaurants')" class="neuro-button text-white px-6 py-3 rounded-lg font-semibold">
                            <span>Find Food</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Featured Categories -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div class="bg-white rounded-xl p-6 text-center shadow-md card-hover cursor-pointer" onclick="filterByCategory('pizza')">
                    <div class="text-4xl mb-3">üçï</div>
                    <h3 class="font-semibold">Pizza</h3>
                </div>
                <div class="bg-white rounded-xl p-6 text-center shadow-md card-hover cursor-pointer" onclick="filterByCategory('burger')">
                    <div class="text-4xl mb-3">üçî</div>
                    <h3 class="font-semibold">Burgers</h3>
                </div>
                <div class="bg-white rounded-xl p-6 text-center shadow-md card-hover cursor-pointer" onclick="filterByCategory('indian')">
                    <div class="text-4xl mb-3">üçõ</div>
                    <h3 class="font-semibold">Indian</h3>
                </div>
                <div class="bg-white rounded-xl p-6 text-center shadow-md card-hover cursor-pointer" onclick="filterByCategory('chinese')">
                    <div class="text-4xl mb-3">ü•°</div>
                    <h3 class="font-semibold">Chinese</h3>
                </div>
            </div>

            <!-- Popular Restaurants -->
            <div>
                <h2 class="text-2xl font-bold mb-6">Popular Restaurants</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="popularRestaurants">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Restaurants Section -->
        <section id="restaurantsSection" class="hidden space-y-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <h2 class="text-3xl font-bold">Restaurants Near You</h2>
                <div class="flex flex-wrap gap-4">
                    <!-- Smart Search with Auto-suggestions -->
                    <div class="relative flex-1 min-w-64">
                        <input type="text" id="searchRestaurants" placeholder="Search restaurants, cuisines, dishes..." 
                               class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 pr-10">
                        <div class="absolute right-3 top-2.5 text-gray-400">üîç</div>
                        <div id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white border border-t-0 rounded-b-lg shadow-lg z-10 hidden max-h-60 overflow-y-auto">
                            <!-- Auto-suggestions populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Advanced Filters -->
                    <div class="flex gap-2">
                        <button id="filterVeg" onclick="toggleFilter('veg')" class="px-3 py-2 border rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <span class="w-3 h-3 border-2 border-green-500 rounded-sm bg-green-100"></span>
                            <span>Veg</span>
                        </button>
                        <button id="filterNonVeg" onclick="toggleFilter('nonveg')" class="px-3 py-2 border rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <span class="w-3 h-3 border-2 border-red-500 rounded-sm bg-red-100"></span>
                            <span>Non-Veg</span>
                        </button>
                        <button id="filterOffers" onclick="toggleFilter('offers')" class="px-3 py-2 border rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <span>üè∑Ô∏è</span>
                            <span>Offers</span>
                        </button>
                        <button id="filterFastDelivery" onclick="toggleFilter('fast')" class="px-3 py-2 border rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <span>‚ö°</span>
                            <span>Fast</span>
                        </button>
                        <button id="filterTopRated" onclick="toggleFilter('toprated')" class="px-3 py-2 border rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <span>‚≠ê</span>
                            <span>Top Rated</span>
                        </button>
                    </div>
                    
                    <!-- Sort Options -->
                    <select id="sortBy" class="px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="popularity">Sort by Popularity</option>
                        <option value="rating">Rating</option>
                        <option value="delivery">Delivery Time</option>
                        <option value="price">Price</option>
                        <option value="distance">Distance</option>
                    </select>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="restaurantsList">
                <!-- Populated by JavaScript -->
            </div>
        </section>

        <!-- Restaurant Menu Section -->
        <section id="menuSection" class="hidden space-y-6">
            <button onclick="showSection('restaurants')" class="flex items-center text-blue-600 hover:text-blue-800 transition-colors">
                ‚Üê Back to Restaurants
            </button>
            <div id="restaurantHeader" class="bg-white rounded-xl p-6 shadow-md">
                <!-- Populated by JavaScript -->
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div class="lg:col-span-3">
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-2xl font-bold mb-6 text-gray-800">Menu</h3>
                        <div id="menuItems" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="lg:col-span-1">
                    <div class="glass-card rounded-xl p-6 sticky top-24">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">Your Order</h3>
                        <div id="cartItems" class="space-y-3 mb-4">
                            <p class="text-gray-500 text-center">Your cart is empty</p>
                        </div>
                        <div id="cartTotal" class="border-t pt-4 hidden">
                            <div class="flex justify-between items-center mb-4">
                                <span class="font-semibold text-gray-800">Total:</span>
                                <span class="font-bold text-lg text-gray-800" id="totalAmount">‚Çπ0</span>
                            </div>
                            <button onclick="proceedToCheckout()" class="w-full neuro-button text-white py-3 rounded-lg font-semibold">
                                <span>Proceed to Checkout</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Orders Section -->
        <section id="ordersSection" class="hidden space-y-6">
            <h2 class="text-3xl font-bold">My Orders</h2>
            <div class="flex gap-4 mb-6">
                <button onclick="filterOrders('all')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">All Orders</button>
                <button onclick="filterOrders('active')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">Active</button>
                <button onclick="filterOrders('completed')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">Completed</button>
            </div>
            <div id="ordersList" class="space-y-4">
                <!-- Populated by JavaScript -->
            </div>
        </section>

        <!-- Profile Section -->
        <section id="profileSection" class="hidden space-y-6">
            <h2 class="text-3xl font-bold">My Profile</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <h3 class="text-xl font-bold mb-4">Personal Information</h3>
                    <form id="profileForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" id="profileName" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" id="profileEmail" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                            <input type="tel" id="profilePhone" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            Update Profile
                        </button>
                    </form>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <h3 class="text-xl font-bold mb-4">Saved Addresses</h3>
                    <div id="savedAddresses" class="space-y-3 mb-4">
                        <!-- Populated by JavaScript -->
                    </div>
                    <button onclick="showAddAddressModal()" class="w-full bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                        + Add New Address
                    </button>
                </div>
            </div>
        </section>

        <!-- Vendor Panel Section -->
        <section id="vendorSection" class="hidden space-y-6">
            <div class="flex justify-between items-center">
                <h2 class="text-3xl font-bold">Vendor Dashboard</h2>
                <button onclick="showSection('home')" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                    Back to Customer View
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-blue-600" id="vendorTotalOrders">24</div>
                    <div class="text-gray-600">Total Orders</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-green-600" id="vendorRevenue">‚Çπ12,450</div>
                    <div class="text-gray-600">Revenue</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-yellow-600" id="vendorRating">4.5</div>
                    <div class="text-gray-600">Average Rating</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-purple-600" id="vendorActiveOrders">3</div>
                    <div class="text-gray-600">Active Orders</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Menu Management</h3>
                        <button onclick="showAddItemModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            + Add Item
                        </button>
                    </div>
                    <div id="vendorMenuItems" class="space-y-3">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <h3 class="text-xl font-bold mb-4">Recent Orders</h3>
                    <div id="vendorOrders" class="space-y-3">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Admin Panel Section -->
        <section id="adminSection" class="hidden space-y-6">
            <div class="flex justify-between items-center">
                <h2 class="text-3xl font-bold">Admin Dashboard</h2>
                <button onclick="showSection('home')" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                    Back to Customer View
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-blue-600">156</div>
                    <div class="text-gray-600">Total Users</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-green-600">23</div>
                    <div class="text-gray-600">Active Vendors</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-yellow-600">89</div>
                    <div class="text-gray-600">Orders Today</div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md text-center">
                    <div class="text-3xl font-bold text-purple-600">‚Çπ45,230</div>
                    <div class="text-gray-600">Revenue Today</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <h3 class="text-xl font-bold mb-4">Vendor Management</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-3 border rounded-lg">
                            <div>
                                <div class="font-semibold">Pizza Palace</div>
                                <div class="text-sm text-gray-600">Status: Active</div>
                            </div>
                            <div class="flex gap-2">
                                <button class="bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors">Edit</button>
                                <button class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors">Suspend</button>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-3 border rounded-lg">
                            <div>
                                <div class="font-semibold">Burger Hub</div>
                                <div class="text-sm text-gray-600">Status: Active</div>
                            </div>
                            <div class="flex gap-2">
                                <button class="bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors">Edit</button>
                                <button class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors">Suspend</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <h3 class="text-xl font-bold mb-4">Recent Activity</h3>
                    <div class="space-y-3">
                        <div class="flex items-center gap-3 p-3 border rounded-lg">
                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                            <div class="flex-1">
                                <div class="font-semibold">New vendor registered</div>
                                <div class="text-sm text-gray-600">Spice Garden - 2 hours ago</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3 p-3 border rounded-lg">
                            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                            <div class="flex-1">
                                <div class="font-semibold">Order completed</div>
                                <div class="text-sm text-gray-600">Order #1234 - 3 hours ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
<!-- Contact Us Section -->
<section id="contactSection" class="hidden relative py-16 px-6 md:px-12 bg-gradient-to-br from-blue-50 via-white to-blue-100">
  
  <!-- Decorative background shapes -->
  <div class="absolute top-10 left-10 w-40 h-40 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse"></div>
  <div class="absolute bottom-10 right-10 w-56 h-56 bg-indigo-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse"></div>

  <div class="relative max-w-4xl mx-auto glass-nav rounded-2xl shadow-xl p-10">
    <h2 class="text-3xl font-bold text-gray-800 mb-4 text-center">üì© Contact Us</h2>
    <p class="text-gray-700 mb-8 text-center">
      Have questions or feedback? We‚Äôd love to hear from you! Fill out the form and we‚Äôll get back to you soon.
    </p>

    <form class="space-y-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
        <input type="text" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none shadow-sm" placeholder="Your Name" required>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
        <input type="email" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none shadow-sm" placeholder="you@example.com" required>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Message</label>
        <textarea rows="5" class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none shadow-sm" placeholder="Write your message..." required></textarea>
      </div>
      <button type="submit" class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-semibold py-3 rounded-xl shadow-md hover:from-blue-600 hover:to-indigo-700 transition-all">
        Send Message ‚ú®
      </button>
    </form>
     <!-- Inline message -->
    <p id="thankYouMsg" class="mt-6 text-center text-green-600 font-semibold hidden">
      ‚úÖ Thank you! Your message has been received.
    </p>

    <div class="mt-10 text-center text-gray-700">
      <p><strong>Email:</strong> support@salsaandspice.com</p>
      <p><strong>Phone:</strong> +91 98765 43210</p>
      <p><strong>Address:</strong> Salsa & Spice HQ, New Delhi, India</p>
    </div>
  </div>
</section>


</main>
    <!-- Footer -->
<footer class="glass-nav text-gray-800 shadow-lg mt-12">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      
      <!-- Brand -->
      <div>
        <h3 class="text-xl font-bold">Salsa & Spice</h3>
        <p class="mt-3 text-sm text-gray-600">
          Delicious food delivered fresh, fast, and full of flavor.
        </p>
      </div>

      <!-- Quick Links -->
      <div>
        <h4 class="text-lg font-semibold">Quick Links</h4>
        <ul class="mt-3 space-y-2">
          <li><a href="#" onclick="showSection('home')" class="hover:text-blue-600 transition-colors">Home</a></li>
          <li><a href="#" onclick="showSection('restaurants')" class="hover:text-blue-600 transition-colors">Restaurants</a></li>
          <li><a href="#" onclick="showSection('orders')" class="hover:text-blue-600 transition-colors">My Orders</a></li>
          <li><a href="#" onclick="showSection('profile')" class="hover:text-blue-600 transition-colors">Profile</a></li>
        </ul>
      </div>

      <!-- Support -->
      <div>
        <h4 class="text-lg font-semibold">Support</h4>
        <ul class="mt-3 space-y-2">
          <li><a href="#" onclick="showSection('contact')" class="hover:text-blue-600 transition-colors">Contact Us</a></li>
        </ul>
      </div>

      <!-- Social -->
      <div>
        <h4 class="text-lg font-semibold">Follow Us</h4>
        <div class="mt-3 flex space-x-4 text-xl">
          <a href="#" class="hover:text-blue-500">üê¶</a>
          <a href="#" class="hover:text-blue-700">üìò</a>
          <a href="#" class="hover:text-pink-500">üì∏</a>
          <a href="#" class="hover:text-red-500">‚ñ∂Ô∏è</a>
        </div>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div class="border-t border-gray-200 mt-8 pt-6 flex flex-col md:flex-row justify-between items-center text-sm text-gray-600">
      <p>¬© 2025 Salsa & Spice. All rights reserved.</p>
      <div class="space-x-4 mt-3 md:mt-0">
        <a href="#" class="hover:text-blue-600 transition-colors">Privacy Policy</a>
        <a href="#" class="hover:text-blue-600 transition-colors">Terms of Service</a>
      </div>
    </div>
  </div>
</footer>

    <!-- Cart Sidebar -->
    <div id="cartSidebar" class="fixed right-0 top-0 h-full w-96 glass-sidebar shadow-xl transform translate-x-full transition-transform duration-300 z-50">
        <div class="p-6 border-b">
            <div class="flex justify-between items-center">
                <h3 class="text-xl font-bold">Your Cart</h3>
                <button onclick="toggleCart()" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
        </div>
        <div class="p-6 flex-1 overflow-y-auto">
            <div id="sidebarCartItems" class="space-y-4 mb-6">
                <p class="text-gray-500 text-center">Your cart is empty</p>
            </div>
        </div>
        <div id="sidebarCartTotal" class="p-6 border-t hidden">
            <div class="flex justify-between items-center mb-4">
                <span class="font-semibold">Total:</span>
                <span class="font-bold text-lg" id="sidebarTotalAmount">‚Çπ0</span>
            </div>
            <button onclick="proceedToCheckout()" class="w-full btn-primary text-white py-3 rounded-lg font-semibold glow-effect">
                Proceed to Checkout
            </button>
        </div>
    </div>

    <!-- Modals -->
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Login</h3>
                <button onclick="closeModal('loginModal')" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                    Login
                </button>
            </form>
            <div class="mt-4 text-center">
                <button onclick="showRegisterModal()" class="text-blue-600 hover:text-blue-800">Don't have an account? Register</button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Register</h3>
                <button onclick="closeModal('registerModal')" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <form id="registerForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input type="text" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                    <input type="tel" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                    Register
                </button>
            </form>
            <div class="mt-4 text-center">
                <button onclick="showLoginModal()" class="text-blue-600 hover:text-blue-800">Already have an account? Login</button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal with Stepper -->
    <div id="checkoutModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="glass-modal rounded-2xl p-8 max-w-4xl w-full mx-4 max-h-screen overflow-y-auto fade-in">
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-3xl font-bold text-gray-800">Checkout</h3>
                <button onclick="closeModal('checkoutModal')" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
            </div>
            
            <!-- Stepper -->
            <div class="stepper">
                <div class="stepper-step active" id="step1">
                    <div class="stepper-circle">üõí</div>
                    <div class="stepper-label">Cart</div>
                </div>
                <div class="stepper-step" id="step2">
                    <div class="stepper-circle">üìç</div>
                    <div class="stepper-label">Address</div>
                </div>
                <div class="stepper-step" id="step3">
                    <div class="stepper-circle">üí≥</div>
                    <div class="stepper-label">Payment</div>
                </div>
                <div class="stepper-step" id="step4">
                    <div class="stepper-circle">‚úÖ</div>
                    <div class="stepper-label">Confirmation</div>
                </div>
            </div>

            <!-- Step Content -->
            <div class="min-h-96">
                <!-- Step 1: Cart Review -->
                <div id="stepContent1" class="step-content">
                    <div class="glass-card rounded-xl p-6">
                        <h4 class="text-xl font-bold mb-4 text-gray-800">Review Your Order</h4>
                        <div id="checkoutItems" class="space-y-4 mb-6">
                            <!-- Populated by JavaScript -->
                        </div>
                        <div class="border-t pt-4 space-y-2">
                            <div class="flex justify-between text-gray-600">
                                <span>Subtotal:</span>
                                <span id="checkoutSubtotal">‚Çπ0</span>
                            </div>
                            <div class="flex justify-between text-gray-600">
                                <span>Delivery Fee:</span>
                                <span>‚Çπ40</span>
                            </div>
                            <div class="flex justify-between text-gray-600">
                                <span>Taxes & Fees:</span>
                                <span>‚Çπ25</span>
                            </div>
                            <div class="flex justify-between font-bold text-xl text-gray-800 border-t pt-2">
                                <span>Total:</span>
                                <span id="checkoutTotal">‚Çπ0</span>
                            </div>
                        </div>
                        <button onclick="nextStep(2)" class="w-full neuro-button text-white py-3 rounded-lg font-semibold">
                            <span>Continue to Address</span>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Address Selection -->
                <div id="stepContent2" class="step-content hidden">
                    <div class="glass-card rounded-xl p-6">
                        <h4 class="text-xl font-bold mb-4 text-gray-800">Delivery Address</h4>
                        <div class="space-y-4 mb-6">
                            <label class="flex items-start space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-colors">
                                <input type="radio" name="address" value="home" checked class="text-blue-600 mt-1">
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-800">üè† Home</div>
                                    <div class="text-gray-600">123 Main Street, Apartment 4B</div>
                                    <div class="text-gray-600">Downtown, City 12345</div>
                                    <div class="text-sm text-green-600 mt-1">‚úì Default address</div>
                                </div>
                            </label>
                            <label class="flex items-start space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-colors">
                                <input type="radio" name="address" value="work" class="text-blue-600 mt-1">
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-800">üè¢ Work</div>
                                    <div class="text-gray-600">456 Business Avenue, Floor 8</div>
                                    <div class="text-gray-600">Business District, City 12346</div>
                                    <div class="text-sm text-blue-600 mt-1">üìç Recently used</div>
                                </div>
                            </label>
                            <button class="w-full p-4 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-300 text-gray-600 hover:text-blue-600 transition-colors">
                                + Add New Address
                            </button>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="prevStep(1)" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                                Back to Cart
                            </button>
                            <button onclick="nextStep(3)" class="flex-1 neuro-button text-white py-3 rounded-lg font-semibold">
                                <span>Continue to Payment</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Payment Method -->
                <div id="stepContent3" class="step-content hidden">
                    <div class="glass-card rounded-xl p-6">
                        <h4 class="text-xl font-bold mb-4 text-gray-800">Payment Method</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            <label class="flex items-center space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-colors">
                                <input type="radio" name="payment" value="upi" checked class="text-blue-600">
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-800">üì± UPI Payment</div>
                                    <div class="text-sm text-gray-600">Google Pay, PhonePe, Paytm</div>
                                </div>
                                <div class="text-2xl">üì±</div>
                            </label>
                            <label class="flex items-center space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-colors">
                                <input type="radio" name="payment" value="card" class="text-blue-600">
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-800">üí≥ Card Payment</div>
                                    <div class="text-sm text-gray-600">Credit/Debit Cards</div>
                                </div>
                                <div class="text-2xl">üí≥</div>
                            </label>
                            <label class="flex items-center space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-colors">
                                <input type="radio" name="payment" value="wallet" class="text-blue-600">
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-800">üëõ Digital Wallet</div>
                                    <div class="text-sm text-gray-600">Paytm, Amazon Pay</div>
                                </div>
                                <div class="text-2xl">üëõ</div>
                            </label>
                            <label class="flex items-center space-x-4 p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 cursor-pointer transition-colors">
                                <input type="radio" name="payment" value="cod" class="text-blue-600">
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-800">üíµ Cash on Delivery</div>
                                    <div class="text-sm text-gray-600">Pay when delivered</div>
                                </div>
                                <div class="text-2xl">üíµ</div>
                            </label>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="prevStep(2)" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                                Back to Address
                            </button>
                            <button onclick="nextStep(4)" class="flex-1 neuro-button text-white py-3 rounded-lg font-semibold">
                                <span>Review Order</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Confirmation -->
                <div id="stepContent4" class="step-content hidden">
                    <div class="glass-card rounded-xl p-6">
                        <h4 class="text-xl font-bold mb-4 text-gray-800">Order Confirmation</h4>
                        <div class="space-y-6 mb-6">
                            <!-- Order Summary -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h5 class="font-semibold mb-2 text-gray-800">Order Summary</h5>
                                <div id="finalOrderItems" class="space-y-2 mb-3">
                                    <!-- Populated by JavaScript -->
                                </div>
                                <div class="border-t pt-2 font-bold text-gray-800">
                                    Total: <span id="finalTotal">‚Çπ0</span>
                                </div>
                            </div>
                            
                            <!-- Delivery Details -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h5 class="font-semibold mb-2 text-gray-800">Delivery Details</h5>
                                <div id="selectedAddress" class="text-gray-600">
                                    <!-- Populated by JavaScript -->
                                </div>
                                <div class="text-sm text-gray-500 mt-2">
                                    Estimated delivery: 25-30 minutes
                                </div>
                            </div>
                            
                            <!-- Payment Details -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h5 class="font-semibold mb-2 text-gray-800">Payment Method</h5>
                                <div id="selectedPayment" class="text-gray-600">
                                    <!-- Populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                        <div class="flex gap-4">
                            <button onclick="prevStep(3)" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                                Back to Payment
                            </button>
                            <button onclick="placeOrder()" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white py-3 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-700 transition-all duration-300 shadow-lg">
                                üéâ Place Order
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Tracking Modal -->
    <div id="trackingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Order Tracking</h3>
                <button onclick="closeModal('trackingModal')" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            
            <div class="space-y-4">
                <div class="text-center mb-6">
                    <div class="text-lg font-semibold" id="trackingOrderId">Order #1234</div>
                    <div class="text-gray-600" id="trackingEstimate">Estimated delivery: 25-30 mins</div>
                </div>

                <!-- Interactive Progress Timeline -->
                <div class="mb-6">
                    <div class="relative" id="progressTimeline">
                        <!-- Progress line background -->
                        <div class="absolute top-6 left-6 right-6 h-1 bg-gray-200 rounded-full"></div>
                        <!-- Animated progress line -->
                        <div class="absolute top-6 left-6 h-1 bg-gradient-to-r from-blue-500 to-green-500 rounded-full transition-all duration-1000" id="progressLine" style="width: 0%"></div>
                        
                        <!-- Timeline steps -->
                        <div class="flex justify-between relative z-10" id="timelineSteps">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="space-y-4" id="trackingSteps">
                    <!-- Populated by JavaScript -->
                </div>

                <!-- Enhanced Live Delivery Tracking Map -->
                <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-semibold">Live Delivery Tracking</h4>
                            <div class="flex items-center gap-2">
                                <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                <span class="text-xs text-green-600 font-medium">Live</span>
                            </div>
                        </div>
                        <div class="relative bg-gradient-to-br from-blue-50 to-green-50 rounded-lg p-4 h-64 overflow-hidden border-2 border-blue-200">
                            <!-- Map Grid Background -->
                            <div class="absolute inset-0 opacity-20">
                                <svg width="100%" height="100%" class="text-gray-400">
                                    <defs>
                                        <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                                            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="currentColor" stroke-width="0.5"/>
                                        </pattern>
                                    </defs>
                                    <rect width="100%" height="100%" fill="url(#grid)" />
                                </svg>
                            </div>
                            
                            <!-- Enhanced Street Map -->
                            <svg class="absolute inset-0 w-full h-full" viewBox="0 0 400 200">
                                <!-- Background Streets -->
                                <g opacity="0.3">
                                    <path d="M0,50 L400,50" stroke="#e5e7eb" stroke-width="2"/>
                                    <path d="M0,100 L400,100" stroke="#e5e7eb" stroke-width="3"/>
                                    <path d="M0,150 L400,150" stroke="#e5e7eb" stroke-width="2"/>
                                    <path d="M100,0 L100,200" stroke="#e5e7eb" stroke-width="2"/>
                                    <path d="M200,0 L200,200" stroke="#e5e7eb" stroke-width="2"/>
                                    <path d="M300,0 L300,200" stroke="#e5e7eb" stroke-width="2"/>
                                </g>
                                
                                <!-- Main delivery route -->
                                <path d="M30,100 L120,100 L120,70 L200,70 L200,100 L280,100 L280,130 L370,130" 
                                      stroke="#cbd5e1" stroke-width="6" fill="none" opacity="0.6" stroke-linecap="round"/>
                                
                                <!-- Animated delivery path -->
                                <path class="route-animation" 
                                      d="M30,100 L120,100 L120,70 L200,70 L200,100 L280,100 L280,130 L370,130" 
                                      stroke="#3b82f6" stroke-width="4" fill="none" stroke-linecap="round"/>
                                
                                <!-- Restaurant marker with enhanced animation -->
                                <g id="restaurantMarker">
                                    <circle cx="30" cy="100" r="15" fill="#10b981" class="delivery-pulse"/>
                                    <circle cx="30" cy="100" r="10" fill="#ffffff"/>
                                    <text x="30" y="106" text-anchor="middle" class="text-lg font-bold fill-green-600">üè™</text>
                                    <text x="30" y="125" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">Restaurant</text>
                                    <!-- Pickup indicator -->
                                    <circle cx="30" cy="100" r="20" fill="none" stroke="#10b981" stroke-width="2" opacity="0.5" class="animate-ping"/>
                                </g>
                                
                                <!-- Enhanced delivery vehicle -->
                                <g id="deliveryVehicle" class="delivery-vehicle">
                                    <circle cx="0" cy="0" r="12" fill="#f59e0b" class="delivery-pulse"/>
                                    <circle cx="0" cy="0" r="8" fill="#ffffff"/>
                                    <text x="0" y="5" text-anchor="middle" class="text-lg">üõµ</text>
                                    <text x="0" y="-18" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">Rahul</text>
                                    <!-- Speed indicator -->
                                    <circle cx="0" cy="0" r="16" fill="none" stroke="#f59e0b" stroke-width="1" opacity="0.3" class="animate-pulse"/>
                                </g>
                                
                                <!-- Destination marker with enhanced animation -->
                                <g id="destinationMarker">
                                    <circle cx="370" cy="130" r="15" fill="#ef4444" class="delivery-pulse"/>
                                    <circle cx="370" cy="130" r="10" fill="#ffffff"/>
                                    <text x="370" y="136" text-anchor="middle" class="text-lg font-bold fill-red-600">üè†</text>
                                    <text x="370" y="155" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">Your Location</text>
                                    <!-- Delivery zone indicator -->
                                    <circle cx="370" cy="130" r="25" fill="none" stroke="#ef4444" stroke-width="2" opacity="0.3" stroke-dasharray="5,5" class="animate-spin"/>
                                </g>
                                
                                <!-- Traffic lights and landmarks -->
                                <g opacity="0.7">
                                    <rect x="118" y="68" width="4" height="8" fill="#fbbf24" rx="2"/>
                                    <rect x="198" y="68" width="4" height="8" fill="#10b981" rx="2"/>
                                    <rect x="278" y="98" width="4" height="8" fill="#ef4444" rx="2"/>
                                </g>
                                
                                <!-- Real-time tracking indicators -->
                                <g id="trackingIndicators">
                                    <!-- Speed zones -->
                                    <rect x="80" y="95" width="40" height="10" fill="#22c55e" opacity="0.2" rx="5"/>
                                    <text x="100" y="103" text-anchor="middle" class="text-xs fill-green-600 font-semibold">Fast Zone</text>
                                    
                                    <rect x="240" y="95" width="40" height="10" fill="#f59e0b" opacity="0.2" rx="5"/>
                                    <text x="260" y="103" text-anchor="middle" class="text-xs fill-orange-600 font-semibold">Traffic</text>
                                </g>
                                
                                <!-- Live GPS trail -->
                                <path id="gpsTrail" d="M30,100" stroke="#3b82f6" stroke-width="2" fill="none" opacity="0.6" stroke-dasharray="3,3" class="animate-pulse"/>
                            </svg>
                            
                            <!-- Real-time info overlay -->
                            <div class="absolute top-2 left-2 bg-white bg-opacity-90 rounded-lg p-2 shadow-md">
                                <div class="text-xs font-semibold text-gray-700">Live Updates</div>
                                <div class="text-xs text-blue-600" id="riderStatus">Moving towards you...</div>
                            </div>
                            
                            <!-- Distance and ETA -->
                            <div class="absolute top-2 right-2 bg-white bg-opacity-90 rounded-lg p-2 shadow-md text-right">
                                <div class="text-xs font-semibold text-gray-700" id="distanceRemaining">1.2 km away</div>
                                <div class="text-xs text-green-600" id="etaRemaining">8 mins</div>
                            </div>
                            
                            <!-- Progress indicator -->
                            <div class="absolute bottom-2 left-4 right-4">
                                <div class="bg-white bg-opacity-80 rounded-lg p-2">
                                    <div class="flex justify-between text-xs text-gray-600 mb-1">
                                        <span>Progress</span>
                                        <span id="deliveryProgress">65%</span>
                                    </div>
                                    <div class="bg-gray-200 rounded-full h-2">
                                        <div class="progress-fill-map bg-gradient-to-r from-blue-500 via-purple-500 to-green-500 h-2 rounded-full transition-all duration-1000" 
                                             id="mapProgressBar" style="width: 65%;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-semibold">Delivery Partner</div>
                            <div class="text-sm text-gray-600">Rahul Kumar - üì± +91 98765 43210</div>
                        </div>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors glow-pulse">
                            Call
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Invoice Modal -->
    <div id="qrInvoiceModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="glass-modal rounded-2xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Order Invoice</h3>
                <button onclick="closeModal('qrInvoiceModal')" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
            </div>
            
            <div class="text-center space-y-6">
                <!-- Order Success Animation -->
                <div class="relative">
                    <div class="w-20 h-20 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce">
                        <span class="text-3xl text-white">‚úÖ</span>
                    </div>
                    <div class="absolute inset-0 w-20 h-20 bg-green-400 rounded-full mx-auto animate-ping opacity-20"></div>
                </div>
                
                <div>
                    <h4 class="text-xl font-bold text-gray-800 mb-2">Order Placed Successfully!</h4>
                    <p class="text-gray-600" id="qrOrderDetails">Order #12345 ‚Ä¢ ‚Çπ299</p>
                </div>
                
                <!-- QR Code -->
                <div class="bg-white p-6 rounded-xl shadow-inner border-2 border-gray-100">
                    <div class="mb-4">
                        <h5 class="font-semibold text-gray-800 mb-2">Scan to Reorder</h5>
                        <p class="text-sm text-gray-600">Save this QR code for instant reordering</p>
                    </div>
                    
                    <!-- QR Code Canvas -->
                    <div id="qrCodeContainer" class="flex justify-center mb-4">
                        <canvas id="qrCodeCanvas" width="200" height="200" class="border rounded-lg"></canvas>
                    </div>
                    
                    <div class="text-xs text-gray-500">
                        QR Code ID: <span id="qrCodeId" class="font-mono">QR-12345</span>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="space-y-3">
                    <button onclick="downloadQRCode()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                        üì± Save QR Code
                    </button>
                    <button onclick="shareOrder()" class="w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors">
                        üì§ Share Order
                    </button>
                    <button onclick="trackOrder()" class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                        üö¥ Track Delivery
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Scanner Modal -->
    <div id="qrScannerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="glass-modal rounded-2xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Scan QR to Reorder</h3>
                <button onclick="closeQRScanner()" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
            </div>
            
            <div class="text-center space-y-6">
                <!-- Real Camera Scanner Section -->
                <div id="cameraSection" class="space-y-4">
                    <!-- QR Scanner Container -->
                    <div class="relative mx-auto w-full max-w-sm h-64 md:w-80 md:h-80 border-2 border-blue-400 rounded-lg overflow-hidden bg-black qr-scanner-container">
                        <!-- Real QR Scanner Element -->
                        <div id="qr-reader" class="w-full h-full"></div>
                        
                        <!-- Scanning Overlay -->
                        <div class="absolute inset-0 pointer-events-none">
                            <!-- Scanning corners -->
                            <div class="absolute top-4 left-4 w-8 h-8 border-l-4 border-t-4 border-green-400 animate-pulse"></div>
                            <div class="absolute top-4 right-4 w-8 h-8 border-r-4 border-t-4 border-green-400 animate-pulse"></div>
                            <div class="absolute bottom-4 left-4 w-8 h-8 border-l-4 border-b-4 border-green-400 animate-pulse"></div>
                            <div class="absolute bottom-4 right-4 w-8 h-8 border-r-4 border-b-4 border-green-400 animate-pulse"></div>
                            
                            <!-- Center target -->
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="w-32 h-32 border-2 border-white border-opacity-50 rounded-lg"></div>
                            </div>
                        </div>
                        
                        <!-- Scanner Status -->
                        <div id="scannerStatus" class="absolute bottom-2 left-2 right-2 text-center">
                            <div class="bg-black bg-opacity-70 text-white text-xs px-3 py-2 rounded-lg">
                                <span id="scannerStatusText">Initializing scanner...</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scanner Controls -->
                    <div class="flex gap-2 justify-center flex-wrap">
                        <button id="startScanBtn" onclick="startQRScanner()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                            üì∑ Start Scanner
                        </button>
                        <button id="stopScanBtn" onclick="stopQRScanner()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors hidden">
                            ‚èπÔ∏è Stop Scanner
                        </button>
                        <button id="switchCameraBtn" onclick="switchQRCamera()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors hidden">
                            üîÑ Switch Camera
                        </button>
                        <button onclick="showFallbackSection()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                            ‚å®Ô∏è Manual Entry
                        </button>
                    </div>
                    
                    <!-- Scanner Info -->
                    <div class="text-center">
                        <h4 class="font-semibold text-gray-800 mb-2">üì± Point camera at QR code</h4>
                        <p class="text-sm text-gray-600">Position the QR code within the frame for automatic detection</p>
                        <div class="mt-2 text-xs text-gray-500">
                            <span id="cameraInfo">Camera: Not started</span>
                        </div>
                    </div>
                </div>
                
                <!-- Fallback: LinkedIn QR Code -->
                <div id="fallbackSection" class="hidden space-y-4">
                    <div class="relative mx-auto w-64 h-64 border-2 border-blue-400 rounded-lg bg-white p-4 shadow-lg">
                        <!-- QR Code for LinkedIn -->
                        <div class="bg-white p-2 rounded-lg border h-full flex items-center justify-center">
                            <svg width="200" height="200" viewBox="0 0 160 160" class="mx-auto">
                                <!-- QR Code pattern for LinkedIn URL -->
                                <rect width="160" height="160" fill="white"/>
                                
                                <!-- Corner markers -->
                                <g fill="black">
                                    <!-- Top-left corner -->
                                    <rect x="0" y="0" width="28" height="28"/>
                                    <rect x="4" y="4" width="20" height="20" fill="white"/>
                                    <rect x="8" y="8" width="12" height="12"/>
                                    
                                    <!-- Top-right corner -->
                                    <rect x="132" y="0" width="28" height="28"/>
                                    <rect x="136" y="4" width="20" height="20" fill="white"/>
                                    <rect x="140" y="8" width="12" height="12"/>
                                    
                                    <!-- Bottom-left corner -->
                                    <rect x="0" y="132" width="28" height="28"/>
                                    <rect x="4" y="136" width="20" height="20" fill="white"/>
                                    <rect x="8" y="140" width="12" height="12"/>
                                    
                                    <!-- Data pattern (simplified representation of LinkedIn URL) -->
                                    <rect x="32" y="8" width="4" height="4"/>
                                    <rect x="40" y="8" width="4" height="4"/>
                                    <rect x="48" y="8" width="4" height="4"/>
                                    <rect x="64" y="8" width="4" height="4"/>
                                    <rect x="72" y="8" width="4" height="4"/>
                                    <rect x="88" y="8" width="4" height="4"/>
                                    <rect x="96" y="8" width="4" height="4"/>
                                    <rect x="104" y="8" width="4" height="4"/>
                                    <rect x="120" y="8" width="4" height="4"/>
                                    
                                    <rect x="8" y="32" width="4" height="4"/>
                                    <rect x="16" y="32" width="4" height="4"/>
                                    <rect x="32" y="32" width="4" height="4"/>
                                    <rect x="48" y="32" width="4" height="4"/>
                                    <rect x="56" y="32" width="4" height="4"/>
                                    <rect x="72" y="32" width="4" height="4"/>
                                    <rect x="88" y="32" width="4" height="4"/>
                                    <rect x="104" y="32" width="4" height="4"/>
                                    <rect x="112" y="32" width="4" height="4"/>
                                    <rect x="128" y="32" width="4" height="4"/>
                                    <rect x="144" y="32" width="4" height="4"/>
                                    
                                    <rect x="32" y="40" width="4" height="4"/>
                                    <rect x="48" y="40" width="4" height="4"/>
                                    <rect x="64" y="40" width="4" height="4"/>
                                    <rect x="80" y="40" width="4" height="4"/>
                                    <rect x="96" y="40" width="4" height="4"/>
                                    <rect x="112" y="40" width="4" height="4"/>
                                    <rect x="136" y="40" width="4" height="4"/>
                                    <rect x="152" y="40" width="4" height="4"/>
                                    
                                    <rect x="8" y="48" width="4" height="4"/>
                                    <rect x="24" y="48" width="4" height="4"/>
                                    <rect x="40" y="48" width="4" height="4"/>
                                    <rect x="56" y="48" width="4" height="4"/>
                                    <rect x="80" y="48" width="4" height="4"/>
                                    <rect x="96" y="48" width="4" height="4"/>
                                    <rect x="120" y="48" width="4" height="4"/>
                                    <rect x="144" y="48" width="4" height="4"/>
                                    
                                    <rect x="16" y="56" width="4" height="4"/>
                                    <rect x="32" y="56" width="4" height="4"/>
                                    <rect x="56" y="56" width="4" height="4"/>
                                    <rect x="72" y="56" width="4" height="4"/>
                                    <rect x="88" y="56" width="4" height="4"/>
                                    <rect x="112" y="56" width="4" height="4"/>
                                    <rect x="128" y="56" width="4" height="4"/>
                                    
                                    <rect x="40" y="64" width="4" height="4"/>
                                    <rect x="48" y="64" width="4" height="4"/>
                                    <rect x="64" y="64" width="4" height="4"/>
                                    <rect x="88" y="64" width="4" height="4"/>
                                    <rect x="104" y="64" width="4" height="4"/>
                                    <rect x="120" y="64" width="4" height="4"/>
                                    <rect x="136" y="64" width="4" height="4"/>
                                    <rect x="152" y="64" width="4" height="4"/>
                                    
                                    <!-- Center alignment pattern -->
                                    <rect x="72" y="72" width="4" height="4"/>
                                    <rect x="76" y="76" width="4" height="4"/>
                                    <rect x="80" y="80" width="4" height="4"/>
                                    <rect x="76" y="84" width="4" height="4"/>
                                    <rect x="72" y="88" width="4" height="4"/>
                                    
                                    <!-- More data pattern -->
                                    <rect x="8" y="96" width="4" height="4"/>
                                    <rect x="24" y="96" width="4" height="4"/>
                                    <rect x="40" y="96" width="4" height="4"/>
                                    <rect x="64" y="96" width="4" height="4"/>
                                    <rect x="88" y="96" width="4" height="4"/>
                                    <rect x="104" y="96" width="4" height="4"/>
                                    <rect x="128" y="96" width="4" height="4"/>
                                    <rect x="144" y="96" width="4" height="4"/>
                                    
                                    <rect x="16" y="104" width="4" height="4"/>
                                    <rect x="32" y="104" width="4" height="4"/>
                                    <rect x="56" y="104" width="4" height="4"/>
                                    <rect x="80" y="104" width="4" height="4"/>
                                    <rect x="96" y="104" width="4" height="4"/>
                                    <rect x="120" y="104" width="4" height="4"/>
                                    <rect x="136" y="104" width="4" height="4"/>
                                    
                                    <rect x="32" y="112" width="4" height="4"/>
                                    <rect x="48" y="112" width="4" height="4"/>
                                    <rect x="72" y="112" width="4" height="4"/>
                                    <rect x="88" y="112" width="4" height="4"/>
                                    <rect x="112" y="112" width="4" height="4"/>
                                    <rect x="128" y="112" width="4" height="4"/>
                                    <rect x="152" y="112" width="4" height="4"/>
                                    
                                    <rect x="8" y="120" width="4" height="4"/>
                                    <rect x="40" y="120" width="4" height="4"/>
                                    <rect x="56" y="120" width="4" height="4"/>
                                    <rect x="80" y="120" width="4" height="4"/>
                                    <rect x="104" y="120" width="4" height="4"/>
                                    <rect x="136" y="120" width="4" height="4"/>
                                    
                                    <rect x="32" y="128" width="4" height="4"/>
                                    <rect x="48" y="128" width="4" height="4"/>
                                    <rect x="64" y="128" width="4" height="4"/>
                                    <rect x="88" y="128" width="4" height="4"/>
                                    <rect x="112" y="128" width="4" height="4"/>
                                    <rect x="144" y="128" width="4" height="4"/>
                                    
                                    <rect x="40" y="136" width="4" height="4"/>
                                    <rect x="56" y="136" width="4" height="4"/>
                                    <rect x="72" y="136" width="4" height="4"/>
                                    <rect x="96" y="136" width="4" height="4"/>
                                    <rect x="120" y="136" width="4" height="4"/>
                                    <rect x="136" y="136" width="4" height="4"/>
                                    
                                    <rect x="32" y="144" width="4" height="4"/>
                                    <rect x="64" y="144" width="4" height="4"/>
                                    <rect x="80" y="144" width="4" height="4"/>
                                    <rect x="104" y="144" width="4" height="4"/>
                                    <rect x="128" y="144" width="4" height="4"/>
                                    <rect x="152" y="144" width="4" height="4"/>
                                    
                                    <rect x="48" y="152" width="4" height="4"/>
                                    <rect x="72" y="152" width="4" height="4"/>
                                    <rect x="88" y="152" width="4" height="4"/>
                                    <rect x="112" y="152" width="4" height="4"/>
                                    <rect x="144" y="152" width="4" height="4"/>
                                </g>
                            </svg>
                        </div>
                        
                        <!-- Clickable overlay -->
                        <div class="absolute inset-0 cursor-pointer" onclick="openLinkedInProfile()" title="Click to open LinkedIn profile"></div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Sample QR Code</h4>
                        <p class="text-sm text-gray-600">Click to visit LinkedIn profile</p>
                    </div>
                </div>
                
                <!-- Toggle between camera and fallback -->
                <div class="flex gap-2 justify-center">
                    <button onclick="showCameraSection()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        üì∑ Use Camera
                    </button>
                    <button onclick="showFallbackSection()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                        üìã Manual Entry
                    </button>
                </div>
                
                <!-- Manual QR Input -->
                <div class="border-t pt-4">
                    <p class="text-sm text-gray-600 mb-3">Or enter QR code manually:</p>
                    <div class="flex gap-2">
                        <input type="text" id="manualQRInput" placeholder="QR-12345" 
                               class="flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-center">
                        <button onclick="processManualQR()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            Scan
                        </button>
                    </div>
                </div>
                
                <!-- Demo QR Codes -->
                <div class="border-t pt-4">
                    <p class="text-sm text-gray-600 mb-3">Try these demo QR codes:</p>
                    <div class="flex gap-2 justify-center">
                        <button onclick="simulateQRScan('QR-PIZZA-001')" class="bg-red-100 text-red-700 px-3 py-1 rounded text-xs hover:bg-red-200 transition-colors">
                            üçï Pizza
                        </button>
                        <button onclick="simulateQRScan('QR-BURGER-002')" class="bg-yellow-100 text-yellow-700 px-3 py-1 rounded text-xs hover:bg-yellow-200 transition-colors">
                            üçî Burger
                        </button>
                        <button onclick="simulateQRScan('QR-INDIAN-003')" class="bg-orange-100 text-orange-700 px-3 py-1 rounded text-xs hover:bg-orange-200 transition-colors">
                            üçõ Indian
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Item Modal (Vendor) -->
    <div id="addItemModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Add Menu Item</h3>
                <button onclick="closeModal('addItemModal')" class="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <form id="addItemForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Item Name</label>
                    <input type="text" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Price (‚Çπ)</label>
                    <input type="number" required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                    <select required class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select Category</option>
                        <option value="appetizer">Appetizer</option>
                        <option value="main">Main Course</option>
                        <option value="dessert">Dessert</option>
                        <option value="beverage">Beverage</option>
                    </select>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                    Add Item
                </button>
            </form>
        </div>
    </div>

    <script>
        // Global state
        let currentUser = null;
        let currentRestaurant = null;
        let cart = [];
        let orders = [];
        let currentSection = 'home';
        let activeFilters = [];
        let searchSuggestions = [];
        let notifications = [];
        let userPreferences = {
            favoriteItems: [],
            orderHistory: [],
            loyaltyPoints: 1250,
            dietaryPreferences: []
        };
        let realTimeSocket = null; // Simulated WebSocket connection
        
        // New feature states
        let currentOfferIndex = 0;
        let offerCarouselInterval = null;
        let qrOrderDatabase = {}; // Store QR code to order mappings
        let liveTrackingInterval = null;
        let deliveryProgress = 0;
        
        // Real QR Scanner states
        let html5QrCode = null;
        let currentCameraId = null;
        let availableCameras = [];
        let isQRScannerRunning = false;

        // Smart Offers Data
        const smartOffers = [
            {
                id: 1,
                title: "üçï Pizza Bonanza",
                subtitle: "Get 2 Large Pizzas for ‚Çπ599",
                description: "Valid on all pizza varieties ‚Ä¢ Free delivery",
                discount: "50% OFF",
                restaurant: "Pizza Palace",
                validUntil: "Tonight 11:59 PM",
                gradient: "from-red-500 to-pink-600",
                emoji: "üçï",
                code: "PIZZA50"
            },
            {
                id: 2,
                title: "üçî Burger Blast",
                subtitle: "Buy 1 Get 1 Free on all Burgers",
                description: "Includes fries and drink ‚Ä¢ Limited time",
                discount: "BOGO",
                restaurant: "Burger Hub",
                validUntil: "Today Only",
                gradient: "from-yellow-500 to-orange-600",
                emoji: "üçî",
                code: "BOGO1"
            },
            {
                id: 3,
                title: "üçõ Spice Special",
                subtitle: "Authentic Indian Feast for ‚Çπ399",
                description: "Biryani + Curry + Naan + Dessert",
                discount: "40% OFF",
                restaurant: "Spice Garden",
                validUntil: "This Weekend",
                gradient: "from-orange-500 to-red-600",
                emoji: "üçõ",
                code: "SPICE40"
            },
            {
                id: 4,
                title: "ü•ó Healthy Monday",
                subtitle: "Fresh Salads & Smoothies",
                description: "Start your week healthy ‚Ä¢ Organic ingredients",
                discount: "30% OFF",
                restaurant: "Green Bowl",
                validUntil: "Every Monday",
                gradient: "from-green-500 to-emerald-600",
                emoji: "ü•ó",
                code: "HEALTHY30"
            },
            {
                id: 5,
                title: "ü•° Chinese Combo",
                subtitle: "Noodles + Rice + Starter for ‚Çπ299",
                description: "Perfect for sharing ‚Ä¢ Authentic flavors",
                discount: "35% OFF",
                restaurant: "Dragon Wok",
                validUntil: "This Week",
                gradient: "from-purple-500 to-indigo-600",
                emoji: "ü•°",
                code: "CHINESE35"
            }
        ];

        // Enhanced sample data with filters and attributes
        const restaurants = [
            {
                id: 1,
                name: "Pizza Palace",
                cuisine: "Italian",
                rating: 4.5,
                deliveryTime: "25-30 mins",
                deliveryFee: 40,
                image: "üçï",
                distance: 2.1,
                popularity: 95,
                hasOffers: true,
                isVeg: false,
                isFastDelivery: false,
                tags: ["pizza", "italian", "cheese", "bread"],
                menu: [
                    { id: 1, name: "Margherita Pizza", price: 299, description: "Fresh tomatoes, mozzarella, basil", category: "pizza", isVeg: true, isPopular: true },
                    { id: 2, name: "Pepperoni Pizza", price: 399, description: "Pepperoni, mozzarella, tomato sauce", category: "pizza", isVeg: false, isPopular: true },
                    { id: 3, name: "Garlic Bread", price: 149, description: "Crispy bread with garlic butter", category: "appetizer", isVeg: true, isPopular: false }
                ]
            },
            {
                id: 2,
                name: "Burger Hub",
                cuisine: "American",
                rating: 4.2,
                deliveryTime: "20-25 mins",
                deliveryFee: 35,
                image: "üçî",
                distance: 1.5,
                popularity: 88,
                hasOffers: false,
                isVeg: false,
                isFastDelivery: true,
                tags: ["burger", "american", "fast food", "fries"],
                menu: [
                    { id: 4, name: "Classic Burger", price: 199, description: "Beef patty, lettuce, tomato, onion", category: "burger", isVeg: false, isPopular: true },
                    { id: 5, name: "Cheese Burger", price: 249, description: "Beef patty with cheese, lettuce, tomato", category: "burger", isVeg: false, isPopular: true },
                    { id: 6, name: "French Fries", price: 99, description: "Crispy golden fries", category: "sides", isVeg: true, isPopular: false }
                ]
            },
            {
                id: 3,
                name: "Spice Garden",
                cuisine: "Indian",
                rating: 4.7,
                deliveryTime: "30-35 mins",
                deliveryFee: 45,
                image: "üçõ",
                distance: 3.2,
                popularity: 92,
                hasOffers: true,
                isVeg: true,
                isFastDelivery: false,
                tags: ["indian", "curry", "spicy", "vegetarian", "biryani"],
                menu: [
                    { id: 7, name: "Butter Chicken", price: 349, description: "Creamy tomato curry with chicken", category: "indian", isVeg: false, isPopular: true },
                    { id: 8, name: "Biryani", price: 299, description: "Fragrant rice with spices and meat", category: "indian", isVeg: false, isPopular: true },
                    { id: 9, name: "Naan", price: 49, description: "Soft Indian bread", category: "bread", isVeg: true, isPopular: false }
                ]
            },
            {
                id: 4,
                name: "Dragon Wok",
                cuisine: "Chinese",
                rating: 4.3,
                deliveryTime: "25-30 mins",
                deliveryFee: 40,
                image: "ü•°",
                distance: 2.8,
                popularity: 85,
                hasOffers: false,
                isVeg: false,
                isFastDelivery: false,
                tags: ["chinese", "noodles", "rice", "stir fry"],
                menu: [
                    { id: 10, name: "Fried Rice", price: 199, description: "Wok-fried rice with vegetables", category: "chinese", isVeg: true, isPopular: true },
                    { id: 11, name: "Chow Mein", price: 229, description: "Stir-fried noodles with vegetables", category: "chinese", isVeg: true, isPopular: true },
                    { id: 12, name: "Spring Rolls", price: 149, description: "Crispy vegetable rolls", category: "appetizer", isVeg: true, isPopular: false }
                ]
            },
            {
                id: 5,
                name: "Green Bowl",
                cuisine: "Healthy",
                rating: 4.6,
                deliveryTime: "15-20 mins",
                deliveryFee: 30,
                image: "ü•ó",
                distance: 1.2,
                popularity: 78,
                hasOffers: true,
                isVeg: true,
                isFastDelivery: true,
                tags: ["healthy", "salad", "vegan", "organic", "bowl"],
                menu: [
                    { id: 13, name: "Buddha Bowl", price: 249, description: "Quinoa, avocado, mixed greens, tahini", category: "healthy", isVeg: true, isPopular: true },
                    { id: 14, name: "Green Smoothie", price: 149, description: "Spinach, banana, mango, coconut water", category: "beverage", isVeg: true, isPopular: false },
                    { id: 15, name: "Protein Salad", price: 299, description: "Grilled tofu, mixed greens, nuts", category: "healthy", isVeg: true, isPopular: true }
                ]
            }
        ];

        // Search suggestions data
        const allSearchTerms = [
            "Pizza", "Burger", "Indian Food", "Chinese", "Healthy", "Biryani", "Noodles", 
            "Margherita", "Butter Chicken", "Fried Rice", "Salad", "Fast Delivery",
            "Pizza Palace", "Burger Hub", "Spice Garden", "Dragon Wok", "Green Bowl"
        ];

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadPopularRestaurants();
            loadRestaurants();
            loadOrders();
            loadProfile();
            setupEventListeners();
            initializeDarkMode();
            initializeUserPreferences();
            updatePersonalizedDashboard();
            
            // Initialize new features
            initializeSmartOffers();
            initializeQRDatabase();
            startOfferCarousel();
            
            // Initialize mobile navigation
            updateMobileNavigation('home');
            
            // Add mobile-specific event listeners
            setupMobileEventListeners();
            document.getElementById("contactForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = {
    name: e.target.name.value,
    email: e.target.email.value,
    message: e.target.message.value
  };

  const thankYouMsg = document.getElementById("thankYouMsg");

  try {
    const res = await fetch("http://localhost:3000/api/contact", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(formData)
    });

    if (res.ok) {
      thankYouMsg.classList.remove("hidden");
      e.target.reset();
      setTimeout(() => { thankYouMsg.classList.add("hidden"); }, 5000);
    } else {
      alert("Oops! Something went wrong.");
    }
  } catch (err) {
    alert("Error: " + err.message);
  }
});
        });

        // Helper functions for new features
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let starsHTML = '';
            
            // Full stars
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<span class="rating-star">‚òÖ</span>';
            }
            
            // Half star
            if (hasHalfStar) {
                starsHTML += '<span class="rating-star">‚òÜ</span>';
            }
            
            // Empty stars
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<span class="rating-star empty">‚òÜ</span>';
            }
            
            return starsHTML;
        }

        function getItemEmoji(category) {
            const emojis = {
                'pizza': 'üçï',
                'burger': 'üçî',
                'indian': 'üçõ',
                'chinese': 'ü•°',
                'healthy': 'ü•ó',
                'appetizer': 'ü•®',
                'main': 'üçΩÔ∏è',
                'dessert': 'üç∞',
                'beverage': 'ü•§',
                'bread': 'üçû',
                'sides': 'üçü'
            };
            return emojis[category] || 'üçΩÔ∏è';
        }

        // Stepper functionality
        let currentStep = 1;

        function nextStep(step) {
            if (step > currentStep) {
                // Hide current step
                document.getElementById(`stepContent${currentStep}`).classList.add('hidden');
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}`).classList.add('completed');
                
                // Show next step
                document.getElementById(`stepContent${step}`).classList.remove('hidden');
                document.getElementById(`step${step}`).classList.add('active');
                
                currentStep = step;
                
                // Update step content based on current step
                if (step === 4) {
                    updateConfirmationStep();
                }
            }
        }

        function prevStep(step) {
            if (step < currentStep) {
                // Hide current step
                document.getElementById(`stepContent${currentStep}`).classList.add('hidden');
                document.getElementById(`step${currentStep}`).classList.remove('active');
                
                // Show previous step
                document.getElementById(`stepContent${step}`).classList.remove('hidden');
                document.getElementById(`step${step}`).classList.add('active');
                document.getElementById(`step${step}`).classList.remove('completed');
                
                currentStep = step;
            }
        }

        function updateConfirmationStep() {
            // Update final order items
            const finalOrderItems = document.getElementById('finalOrderItems');
            finalOrderItems.innerHTML = cart.map(item => `
                <div class="flex justify-between">
                    <span>${item.name} x ${item.quantity}</span>
                    <span>‚Çπ${item.price * item.quantity}</span>
                </div>
            `).join('');
            
            // Update final total
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal + 40 + 25; // delivery + taxes
            document.getElementById('finalTotal').textContent = `‚Çπ${total}`;
            
            // Update selected address
            const selectedAddressRadio = document.querySelector('input[name="address"]:checked');
            const addressLabels = {
                'home': 'üè† Home - 123 Main Street, Apartment 4B, Downtown, City 12345',
                'work': 'üè¢ Work - 456 Business Avenue, Floor 8, Business District, City 12346'
            };
            document.getElementById('selectedAddress').textContent = addressLabels[selectedAddressRadio.value];
            
            // Update selected payment
            const selectedPaymentRadio = document.querySelector('input[name="payment"]:checked');
            const paymentLabels = {
                'upi': 'üì± UPI Payment (Google Pay, PhonePe, Paytm)',
                'card': 'üí≥ Card Payment (Credit/Debit Cards)',
                'wallet': 'üëõ Digital Wallet (Paytm, Amazon Pay)',
                'cod': 'üíµ Cash on Delivery'
            };
            document.getElementById('selectedPayment').textContent = paymentLabels[selectedPaymentRadio.value];
        }

        function setupEventListeners() {
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('#userMenu') && !e.target.closest('button[onclick="toggleUserMenu()"]')) {
                    document.getElementById('userMenu').classList.add('hidden');
                }
                if (!e.target.closest('#searchSuggestions') && !e.target.closest('#searchRestaurants')) {
                    document.getElementById('searchSuggestions').classList.add('hidden');
                }
                if (!e.target.closest('#notificationsDropdown') && !e.target.closest('button[onclick="toggleNotifications()"]')) {
                    document.getElementById('notificationsDropdown').classList.add('hidden');
                }
            });

            // Enhanced search functionality with auto-suggestions
            const searchInput = document.getElementById('searchRestaurants');
            searchInput.addEventListener('input', function(e) {
                const query = e.target.value.trim();
                if (query.length > 0) {
                    showSearchSuggestions(query);
                    performSmartSearch(query);
                } else {
                    hideSearchSuggestions();
                    loadRestaurants(); // Show all restaurants
                }
            });

            searchInput.addEventListener('focus', function(e) {
                if (e.target.value.trim().length > 0) {
                    showSearchSuggestions(e.target.value.trim());
                }
            });

            // Sort functionality
            document.getElementById('sortBy').addEventListener('change', function(e) {
                sortRestaurants(e.target.value);
            });

            // Form submissions
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            document.getElementById('addItemForm').addEventListener('submit', handleAddItem);

            // Initialize real-time notifications simulation
            initializeRealTimeNotifications();
        }

        function setupMobileEventListeners() {
            // Handle mobile menu overlay clicks
            document.getElementById('mobileMenuOverlay').addEventListener('click', function(e) {
                if (e.target === this) {
                    toggleMobileMenu();
                }
            });

            // Handle swipe gestures for mobile navigation
            let touchStartX = 0;
            let touchEndX = 0;

            document.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].screenX;
            });

            document.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipeGesture();
            });

            function handleSwipeGesture() {
                const swipeThreshold = 100;
                const swipeDistance = touchEndX - touchStartX;

                // Only handle swipes on the main content area
                if (Math.abs(swipeDistance) > swipeThreshold) {
                    if (swipeDistance > 0) {
                        // Swipe right - go to previous section
                        navigateToPreviousSection();
                    } else {
                        // Swipe left - go to next section
                        navigateToNextSection();
                    }
                }
            }

            // Prevent zoom on double tap for better mobile experience
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);

            // Handle orientation change
            window.addEventListener('orientationchange', function() {
                setTimeout(() => {
                    // Recalculate layouts after orientation change
                    if (html5QrCode && isQRScannerRunning) {
                        // Restart QR scanner to adjust to new orientation
                        stopQRScanner();
                        setTimeout(() => {
                            startQRScanner();
                        }, 500);
                    }
                }, 500);
            });

            // Handle viewport resize for mobile keyboards
            let initialViewportHeight = window.innerHeight;
            window.addEventListener('resize', function() {
                const currentHeight = window.innerHeight;
                const heightDifference = initialViewportHeight - currentHeight;
                
                // If height decreased significantly, likely keyboard is open
                if (heightDifference > 150) {
                    document.body.classList.add('keyboard-open');
                } else {
                    document.body.classList.remove('keyboard-open');
                }
            });
        }

        function navigateToPreviousSection() {
            const sections = ['home', 'restaurants', 'orders', 'profile'];
            const currentIndex = sections.indexOf(currentSection);
            if (currentIndex > 0) {
                showSection(sections[currentIndex - 1]);
            }
        }

        function navigateToNextSection() {
            const sections = ['home', 'restaurants', 'orders', 'profile'];
            const currentIndex = sections.indexOf(currentSection);
            if (currentIndex < sections.length - 1) {
                showSection(sections[currentIndex + 1]);
            }
        }

        // Navigation functions
        function showSection(section) {
            // Hide all sections
            const sections = ['homeSection', 'restaurantsSection', 'menuSection', 'ordersSection', 'profileSection', 'vendorSection', 'adminSection','contactSection'];
            sections.forEach(s => {
                document.getElementById(s).classList.add('hidden');
            });

            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            currentSection = section;

            // Update mobile bottom navigation
            updateMobileNavigation(section);

            // Load section-specific data
            if (section === 'restaurants') {
                loadRestaurants();
            } else if (section === 'orders') {
                loadOrders();
            } else if (section === 'profile') {
                loadProfile();
            } else if (section === 'vendor') {
                loadVendorDashboard();
            }
        }

        function updateMobileNavigation(activeSection) {
            // Reset all mobile nav buttons
            const mobileNavButtons = ['mobileHome', 'mobileRestaurants', 'mobileOrders', 'mobileProfile'];
            mobileNavButtons.forEach(buttonId => {
                const button = document.getElementById(buttonId);
                if (button) {
                    button.classList.remove('text-blue-600', 'font-semibold');
                    button.classList.add('text-gray-600');
                }
            });

            // Highlight active section
            const activeButtonMap = {
                'home': 'mobileHome',
                'restaurants': 'mobileRestaurants',
                'orders': 'mobileOrders',
                'profile': 'mobileProfile'
            };

            const activeButtonId = activeButtonMap[activeSection];
            if (activeButtonId) {
                const activeButton = document.getElementById(activeButtonId);
                if (activeButton) {
                    activeButton.classList.remove('text-gray-600');
                    activeButton.classList.add('text-blue-600', 'font-semibold');
                }
            }
        }

        function toggleMobileMenu() {
            const overlay = document.getElementById('mobileMenuOverlay');
            const menuBtn = document.getElementById('mobileMenuBtn');
            
            if (overlay.classList.contains('hidden')) {
                overlay.classList.remove('hidden');
                menuBtn.innerHTML = '<span class="text-xl">‚úï</span>';
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            } else {
                overlay.classList.add('hidden');
                menuBtn.innerHTML = '<span class="text-xl">‚ò∞</span>';
                document.body.style.overflow = ''; // Restore scrolling
            }
        }

        function toggleUserMenu() {
            const menu = document.getElementById('userMenu');
            menu.classList.toggle('hidden');
        }

        function toggleCart() {
            const sidebar = document.getElementById('cartSidebar');
            sidebar.classList.toggle('translate-x-full');
            updateSidebarCart();
        }

        // Restaurant functions
        function loadPopularRestaurants() {
            const container = document.getElementById('popularRestaurants');
            const popular = restaurants.slice(0, 3);
            
            container.innerHTML = popular.map(restaurant => `
                <div class="restaurant-card cursor-pointer" onclick="showRestaurantMenu(${restaurant.id})">
                    <div class="p-6">
                        <div class="text-6xl mb-4 text-center svg-float">${restaurant.image}</div>
                        <h3 class="font-bold text-xl mb-2 text-gray-800">${restaurant.name}</h3>
                        <p class="text-gray-600 mb-3">${restaurant.cuisine}</p>
                        <div class="flex justify-between items-center mb-4">
                            <div class="rating-stars">
                                ${generateStars(restaurant.rating)}
                                <span class="ml-2 text-sm font-semibold text-gray-700">${restaurant.rating}</span>
                            </div>
                            <span class="text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full">üïí ${restaurant.deliveryTime}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Delivery ‚Çπ${restaurant.deliveryFee}</span>
                            ${restaurant.hasOffers ? '<span class="text-xs bg-red-100 text-red-600 px-2 py-1 rounded-full">üè∑Ô∏è Offers</span>' : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadRestaurants() {
            const container = document.getElementById('restaurantsList');
            
            container.innerHTML = restaurants.map(restaurant => `
                <div class="restaurant-card cursor-pointer" onclick="showRestaurantMenu(${restaurant.id})">
                    <div class="relative">
                        <div class="text-6xl mb-4 text-center py-8 svg-bounce">${restaurant.image}</div>
                        ${restaurant.hasOffers ? '<div class="absolute top-4 right-4 bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold">üè∑Ô∏è OFFERS</div>' : ''}
                        ${restaurant.isFastDelivery ? '<div class="absolute top-4 left-4 bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">‚ö° FAST</div>' : ''}
                    </div>
                    <div class="p-6">
                        <h3 class="font-bold text-xl mb-2 text-gray-800">${restaurant.name}</h3>
                        <p class="text-gray-600 mb-3">${restaurant.cuisine}</p>
                        <div class="flex justify-between items-center mb-4">
                            <div class="rating-stars">
                                ${generateStars(restaurant.rating)}
                                <span class="ml-2 text-sm font-semibold text-gray-700">${restaurant.rating}</span>
                            </div>
                            <span class="text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full">üïí ${restaurant.deliveryTime}</span>
                        </div>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-sm text-gray-600">üìç ${restaurant.distance} km ‚Ä¢ üöö ‚Çπ${restaurant.deliveryFee}</span>
                            <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full">üìà ${restaurant.popularity}% match</span>
                        </div>
                        <button class="w-full neuro-button text-white py-3 rounded-lg font-semibold transition-all duration-300">
                            <span>View Menu</span>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showRestaurantMenu(restaurantId) {
            currentRestaurant = restaurants.find(r => r.id === restaurantId);
            if (!currentRestaurant) return;

            // Update restaurant header
            document.getElementById('restaurantHeader').innerHTML = `
                <div class="flex items-center gap-6">
                    <div class="text-6xl">${currentRestaurant.image}</div>
                    <div class="flex-1">
                        <h2 class="text-3xl font-bold mb-2">${currentRestaurant.name}</h2>
                        <p class="text-gray-600 mb-2">${currentRestaurant.cuisine}</p>
                        <div class="flex items-center gap-4 text-sm">
                            <span class="flex items-center bg-green-100 text-green-800 px-3 py-1 rounded-full">‚≠ê ${currentRestaurant.rating}</span>
                            <span class="text-gray-600">üïí ${currentRestaurant.deliveryTime}</span>
                            <span class="text-gray-600">üöö ‚Çπ${currentRestaurant.deliveryFee} delivery</span>
                        </div>
                    </div>
                </div>
            `;

            // Update menu items
            const menuContainer = document.getElementById('menuItems');
            menuContainer.innerHTML = currentRestaurant.menu.map((item, index) => `
                <div class="menu-card fade-in" style="animation-delay: ${index * 0.1}s">
                    <div class="menu-card-image">
                        <div class="text-4xl">${getItemEmoji(item.category)}</div>
                    </div>
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-3">
                            <h4 class="font-bold text-xl text-gray-800">${item.name}</h4>
                            ${item.isVeg ? '<span class="w-4 h-4 border-2 border-green-500 rounded-sm bg-green-100 flex items-center justify-center"><div class="w-2 h-2 bg-green-500 rounded-full"></div></span>' : '<span class="w-4 h-4 border-2 border-red-500 rounded-sm bg-red-100 flex items-center justify-center"><div class="w-2 h-2 bg-red-500 rounded-full"></div></span>'}
                        </div>
                        <p class="text-gray-600 text-sm mb-4 leading-relaxed">${item.description}</p>
                        <div class="flex justify-between items-center mb-4">
                            <div class="price-badge">‚Çπ${item.price}</div>
                            ${item.isPopular ? '<span class="text-xs bg-orange-100 text-orange-600 px-2 py-1 rounded-full font-semibold">üî• Popular</span>' : ''}
                        </div>
                        <button onclick="addToCart(${item.id})" class="add-to-cart-btn w-full">
                            <span>Add to Cart</span>
                        </button>
                    </div>
                </div>
            `).join('');

            showSection('menu');
            updateCartDisplay();
        }

        function filterByCategory(category) {
            showSection('restaurants');
            // Filter restaurants by category - simplified for demo
            setTimeout(() => {
                const filtered = restaurants.filter(r => 
                    r.menu.some(item => item.category === category)
                );
                displayFilteredRestaurants(filtered);
            }, 100);
        }

        function displayFilteredRestaurants(filteredRestaurants) {
            const container = document.getElementById('restaurantsList');
            container.innerHTML = filteredRestaurants.map(restaurant => `
                <div class="bg-white rounded-xl shadow-md overflow-hidden card-hover cursor-pointer" onclick="showRestaurantMenu(${restaurant.id})">
                    <div class="p-6">
                        <div class="text-5xl mb-4 text-center">${restaurant.image}</div>
                        <h3 class="font-bold text-xl mb-2">${restaurant.name}</h3>
                        <p class="text-gray-600 mb-3">${restaurant.cuisine}</p>
                        <div class="flex justify-between items-center text-sm mb-4">
                            <span class="flex items-center bg-green-100 text-green-800 px-2 py-1 rounded">‚≠ê ${restaurant.rating}</span>
                            <span class="text-gray-600">${restaurant.deliveryTime}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Delivery ‚Çπ${restaurant.deliveryFee}</span>
                            <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                View Menu
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Cart functions
        function addToCart(itemId) {
            const item = currentRestaurant.menu.find(i => i.id === itemId);
            if (!item) return;

            // Find the button that was clicked for animation
            const button = event.target;
            
            // Add bounce animation to cart icon
            const cartIcon = document.querySelector('button[onclick="toggleCart()"]');
            cartIcon.classList.add('cart-bounce');
            setTimeout(() => cartIcon.classList.remove('cart-bounce'), 600);
            
            // Add animation to the clicked button
            button.classList.add('item-add-animation');
            setTimeout(() => button.classList.remove('item-add-animation'), 800);

            const existingItem = cart.find(i => i.id === itemId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...item, quantity: 1, restaurantId: currentRestaurant.id });
            }

            updateCartDisplay();
            updateCartCount();
            
            // Show success message with animation
            showNotification('Item added to cart! üõí', 'success');
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartDisplay();
            updateCartCount();
        }

        function updateQuantity(itemId, change) {
            const item = cart.find(i => i.id === itemId);
            if (!item) return;

            // Find quantity display element for animation
            const quantityElements = document.querySelectorAll(`[data-item-id="${itemId}"] .quantity-display`);
            
            item.quantity += change;
            if (item.quantity <= 0) {
                // Add shake animation before removing
                quantityElements.forEach(el => {
                    el.classList.add('shake-animation');
                });
                setTimeout(() => removeFromCart(itemId), 500);
            } else {
                // Add pulse animation to quantity change
                quantityElements.forEach(el => {
                    el.classList.add('quantity-change');
                    setTimeout(() => el.classList.remove('quantity-change'), 400);
                });
                updateCartDisplay();
                updateCartCount();
            }
        }

        function updateCartDisplay() {
            const cartContainer = document.getElementById('cartItems');
            const sidebarContainer = document.getElementById('sidebarCartItems');
            const cartTotal = document.getElementById('cartTotal');
            const sidebarTotal = document.getElementById('sidebarCartTotal');

            if (cart.length === 0) {
                const emptyMessage = '<p class="text-gray-500 text-center">Your cart is empty</p>';
                cartContainer.innerHTML = emptyMessage;
                sidebarContainer.innerHTML = emptyMessage;
                cartTotal.classList.add('hidden');
                sidebarTotal.classList.add('hidden');
                return;
            }

            const cartHTML = cart.map(item => `
                <div class="flex justify-between items-center p-3 border rounded-lg fade-in" data-item-id="${item.id}">
                    <div class="flex-1">
                        <h5 class="font-semibold">${item.name}</h5>
                        <p class="text-sm text-gray-600">‚Çπ${item.price} each</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="updateQuantity(${item.id}, -1)" class="w-8 h-8 bg-red-100 text-red-600 rounded-full flex items-center justify-center hover:bg-red-200 transition-all duration-200 hover:scale-110">-</button>
                        <span class="w-8 text-center font-semibold quantity-display">${item.quantity}</span>
                        <button onclick="updateQuantity(${item.id}, 1)" class="w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center hover:bg-green-200 transition-all duration-200 hover:scale-110">+</button>
                    </div>
                </div>
            `).join('');

            cartContainer.innerHTML = cartHTML;
            sidebarContainer.innerHTML = cartHTML;

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('totalAmount').textContent = `‚Çπ${total}`;
            document.getElementById('sidebarTotalAmount').textContent = `‚Çπ${total}`;

            cartTotal.classList.remove('hidden');
            sidebarTotal.classList.remove('hidden');
        }

        function updateSidebarCart() {
            updateCartDisplay();
        }

        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // Checkout functions
        function proceedToCheckout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }

            // Reset stepper to first step
            currentStep = 1;
            
            // Reset all steps
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`stepContent${i}`).classList.add('hidden');
                document.getElementById(`step${i}`).classList.remove('active', 'completed');
            }
            
            // Show first step
            document.getElementById('stepContent1').classList.remove('hidden');
            document.getElementById('step1').classList.add('active');

            // Update checkout modal with cart items
            const checkoutItems = document.getElementById('checkoutItems');
            checkoutItems.innerHTML = cart.map(item => `
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-3">
                        <div class="text-2xl">${getItemEmoji(item.category)}</div>
                        <div>
                            <div class="font-semibold text-gray-800">${item.name}</div>
                            <div class="text-sm text-gray-600">‚Çπ${item.price} each</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-semibold text-gray-800">x${item.quantity}</div>
                        <div class="text-sm text-gray-600">‚Çπ${item.price * item.quantity}</div>
                    </div>
                </div>
            `).join('');

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const deliveryFee = 40;
            const taxesFees = 25;
            const total = subtotal + deliveryFee + taxesFees;

            document.getElementById('checkoutSubtotal').textContent = `‚Çπ${subtotal}`;
            document.getElementById('checkoutTotal').textContent = `‚Çπ${total}`;

            showModal('checkoutModal');
        }

        function placeOrder() {
            const orderId = Date.now();
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal + 40; // delivery fee

            const order = {
                id: orderId,
                items: [...cart],
                restaurant: currentRestaurant.name,
                total: total,
                status: 'confirmed',
                timestamp: new Date(),
                estimatedDelivery: new Date(Date.now() + 30 * 60000) // 30 minutes
            };

            orders.unshift(order);
            cart = [];
            
            updateCartDisplay();
            updateCartCount();
            closeModal('checkoutModal');
            
            showNotification('Order placed successfully!', 'success');
            
            // Start order tracking
            setTimeout(() => {
                showOrderTracking(orderId);
            }, 1000);

            // Simulate order status updates
            simulateOrderProgress(orderId);
        }

        function simulateOrderProgress(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const statuses = ['confirmed', 'preparing', 'ready', 'out_for_delivery', 'delivered'];
            let currentStatusIndex = 0;

            const updateStatus = () => {
                if (currentStatusIndex < statuses.length - 1) {
                    currentStatusIndex++;
                    order.status = statuses[currentStatusIndex];
                    
                    // Update tracking modal if open
                    const modal = document.getElementById('trackingModal');
                    if (!modal.classList.contains('hidden')) {
                        updateTrackingDisplay(order);
                    }
                    
                    showNotification(`Order ${order.status.replace('_', ' ')}!`, 'info');
                    
                    // Schedule next update
                    setTimeout(updateStatus, Math.random() * 10000 + 5000); // 5-15 seconds
                }
            };

            // Start first update after 5 seconds
            setTimeout(updateStatus, 5000);
        }

        // Order tracking functions
        function showOrderTracking(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            document.getElementById('trackingOrderId').textContent = `Order #${order.id}`;
            updateTrackingDisplay(order);
            showModal('trackingModal');
        }

        function updateTrackingDisplay(order) {
            const steps = [
                { key: 'confirmed', label: 'Order Confirmed', icon: 'üõí', color: 'blue', emoji: 'üõí' },
                { key: 'preparing', label: 'Preparing Food', icon: 'üç≥', color: 'yellow', emoji: 'üç≥' },
                { key: 'ready', label: 'Ready for Pickup', icon: 'üì¶', color: 'purple', emoji: 'üì¶' },
                { key: 'out_for_delivery', label: 'Out for Delivery', icon: 'üö¥', color: 'orange', emoji: 'üö¥' },
                { key: 'delivered', label: 'Delivered', icon: '‚úÖ', color: 'green', emoji: '‚úÖ' }
            ];

            const currentIndex = steps.findIndex(step => step.key === order.status);
            
            // Update interactive timeline
            updateInteractiveTimeline(steps, currentIndex);
            
            // Update detailed steps
            const stepsHTML = steps.map((step, index) => {
                const isCompleted = index <= currentIndex;
                const isCurrent = index === currentIndex;
                
                return `
                    <div class="flex items-center gap-4 transition-all duration-500 ${isCompleted ? 'text-green-600' : 'text-gray-400'}" style="animation-delay: ${index * 0.1}s">
                        <div class="w-12 h-12 rounded-full flex items-center justify-center text-xl transition-all duration-500 ${
                            isCompleted ? 'bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg' : 'bg-gray-100 border-2 border-gray-300'
                        } ${isCurrent ? 'order-step-active pulse-animation' : ''}">
                            ${step.icon}
                        </div>
                        <div class="flex-1">
                            <div class="font-semibold transition-all duration-300 text-lg">${step.label}</div>
                            ${isCurrent ? '<div class="text-sm text-blue-600 animate-pulse font-medium">In progress...</div>' : ''}
                            ${isCompleted && !isCurrent ? '<div class="text-sm text-green-600 font-medium">Completed ‚úì</div>' : ''}
                            ${getStepDescription(step.key, isCurrent)}
                        </div>
                        <div class="flex items-center">
                            ${isCompleted ? '<div class="text-green-600 text-2xl animate-bounce">‚úì</div>' : '<div class="w-5 h-5 border-2 border-gray-300 rounded-full"></div>'}
                        </div>
                    </div>
                    ${index < steps.length - 1 ? `
                        <div class="ml-6 w-0.5 h-8 transition-all duration-500 ${isCompleted ? 'bg-gradient-to-b from-green-500 to-emerald-600' : 'bg-gray-300'}"></div>
                    ` : ''}
                `;
            }).join('');

            const container = document.getElementById('trackingSteps');
            container.innerHTML = stepsHTML;
            
            // Update map progress and rider status
            updateMapProgress(order.status, currentIndex, steps.length);
            
            // Add status transition animation to the container
            container.classList.add('status-transition');
            setTimeout(() => container.classList.remove('status-transition'), 800);
        }

        function updateInteractiveTimeline(steps, currentIndex) {
            const timelineContainer = document.getElementById('timelineSteps');
            const progressLine = document.getElementById('progressLine');
            
            // Calculate progress percentage
            const progressPercentage = currentIndex >= 0 ? ((currentIndex + 1) / steps.length) * 100 : 0;
            progressLine.style.width = `${progressPercentage}%`;
            
            // Generate timeline steps
            const timelineHTML = steps.map((step, index) => {
                const isCompleted = index <= currentIndex;
                const isCurrent = index === currentIndex;
                
                return `
                    <div class="flex flex-col items-center timeline-step ${isCompleted ? 'completed' : ''} ${isCurrent ? 'active' : ''}">
                        <div class="w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold transition-all duration-500 ${
                            isCompleted 
                                ? 'bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg transform scale-110' 
                                : isCurrent 
                                    ? 'bg-gradient-to-r from-blue-400 to-indigo-500 text-white shadow-lg animate-pulse' 
                                    : 'bg-gray-200 text-gray-500'
                        }">
                            ${step.emoji}
                        </div>
                        <div class="mt-2 text-xs font-semibold text-center ${isCompleted ? 'text-green-600' : isCurrent ? 'text-blue-600' : 'text-gray-500'}">
                            ${step.label.split(' ')[0]}
                        </div>
                    </div>
                `;
            }).join('');
            
            timelineContainer.innerHTML = timelineHTML;
        }

        function getStepDescription(stepKey, isCurrent) {
            const descriptions = {
                'confirmed': isCurrent ? 'Your order has been received and confirmed' : '',
                'preparing': isCurrent ? 'Chef is preparing your delicious meal' : '',
                'ready': isCurrent ? 'Food is ready and waiting for pickup' : '',
                'out_for_delivery': isCurrent ? 'Delivery partner is on the way to you' : '',
                'delivered': isCurrent ? 'Enjoy your meal!' : ''
            };
            
            return descriptions[stepKey] ? `<div class="text-xs text-gray-600 mt-1">${descriptions[stepKey]}</div>` : '';
        }

        function updateMapProgress(status, currentIndex, totalSteps) {
            const progressBar = document.getElementById('mapProgressBar');
            const progressText = document.getElementById('deliveryProgress');
            const riderStatus = document.getElementById('riderStatus');
            const distanceElement = document.getElementById('distanceRemaining');
            const etaElement = document.getElementById('etaRemaining');
            
            // Calculate progress based on status
            const progressPercentage = ((currentIndex + 1) / totalSteps) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            progressText.textContent = `${Math.round(progressPercentage)}%`;
            
            // Update status messages and info
            const statusUpdates = {
                'confirmed': {
                    status: 'Order confirmed, preparing to cook...',
                    distance: '2.5 km away',
                    eta: '25-30 mins'
                },
                'preparing': {
                    status: 'Chef is cooking your meal...',
                    distance: '2.5 km away',
                    eta: '20-25 mins'
                },
                'ready': {
                    status: 'Food ready, rider assigned...',
                    distance: '2.5 km away',
                    eta: '15-20 mins'
                },
                'out_for_delivery': {
                    status: 'Rider is coming to you...',
                    distance: '1.2 km away',
                    eta: '8-12 mins'
                },
                'delivered': {
                    status: 'Order delivered successfully!',
                    distance: 'Arrived',
                    eta: 'Delivered'
                }
            };
            
            const update = statusUpdates[status] || statusUpdates['confirmed'];
            riderStatus.textContent = update.status;
            distanceElement.textContent = update.distance;
            etaElement.textContent = update.eta;
        }

        // Orders functions
        function loadOrders() {
            const container = document.getElementById('ordersList');
            
            if (orders.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üçΩÔ∏è</div>
                        <h3 class="text-xl font-semibold mb-2">No orders yet</h3>
                        <p class="text-gray-600 mb-6">Start by ordering from your favorite restaurant</p>
                        <button onclick="showSection('restaurants')" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                            Browse Restaurants
                        </button>
                    </div>
                `;
                return;
            }

            container.innerHTML = orders.map(order => `
                <div class="bg-white rounded-xl p-6 shadow-md">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-bold text-lg">Order #${order.id}</h3>
                            <p class="text-gray-600">${order.restaurant}</p>
                            <p class="text-sm text-gray-500">${order.timestamp.toLocaleDateString()} ${order.timestamp.toLocaleTimeString()}</p>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-lg">‚Çπ${order.total}</div>
                            <span class="px-3 py-1 rounded-full text-sm ${getStatusColor(order.status)}">
                                ${order.status.replace('_', ' ').toUpperCase()}
                            </span>
                        </div>
                    </div>
                    <div class="border-t pt-4">
                        <div class="flex justify-between items-center">
                            <div class="text-sm text-gray-600">
                                ${order.items.length} item(s) ‚Ä¢ ${order.items.map(item => `${item.name} x${item.quantity}`).join(', ')}
                            </div>
                            <div class="flex gap-2">
                                ${order.status !== 'delivered' ? `
                                    <button onclick="showOrderTracking(${order.id})" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                        Track Order
                                    </button>
                                ` : `
                                    <button onclick="reorder(${order.id})" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                        Reorder
                                    </button>
                                    <button onclick="showReviewModal(${order.id})" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors">
                                        Review
                                    </button>
                                `}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getStatusColor(status) {
            const colors = {
                'confirmed': 'bg-gradient-to-r from-blue-400 to-blue-600 text-white status-badge',
                'preparing': 'bg-gradient-to-r from-yellow-400 to-orange-500 text-white status-badge',
                'ready': 'bg-gradient-to-r from-purple-400 to-pink-500 text-white status-badge',
                'out_for_delivery': 'bg-gradient-to-r from-orange-400 to-red-500 text-white status-badge',
                'delivered': 'bg-gradient-to-r from-green-400 to-emerald-600 text-white status-badge'
            };
            return colors[status] || 'bg-gradient-to-r from-gray-400 to-gray-600 text-white status-badge';
        }

        function filterOrders(type) {
            // Update button styles
            const buttons = document.querySelectorAll('#ordersSection button');
            buttons.forEach(btn => {
                btn.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors';
            });
            event.target.className = 'px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors';

            // Filter and display orders
            let filteredOrders = orders;
            if (type === 'active') {
                filteredOrders = orders.filter(order => order.status !== 'delivered');
            } else if (type === 'completed') {
                filteredOrders = orders.filter(order => order.status === 'delivered');
            }

            // Update display with filtered orders
            const container = document.getElementById('ordersList');
            if (filteredOrders.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üìã</div>
                        <h3 class="text-xl font-semibold mb-2">No ${type} orders</h3>
                        <p class="text-gray-600">Orders will appear here when available</p>
                    </div>
                `;
            } else {
                // Use the same rendering logic as loadOrders but with filtered data
                container.innerHTML = filteredOrders.map(order => `
                    <div class="bg-white rounded-xl p-6 shadow-md">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-bold text-lg">Order #${order.id}</h3>
                                <p class="text-gray-600">${order.restaurant}</p>
                                <p class="text-sm text-gray-500">${order.timestamp.toLocaleDateString()} ${order.timestamp.toLocaleTimeString()}</p>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-lg">‚Çπ${order.total}</div>
                                <span class="px-3 py-1 rounded-full text-sm ${getStatusColor(order.status)}">
                                    ${order.status.replace('_', ' ').toUpperCase()}
                                </span>
                            </div>
                        </div>
                        <div class="border-t pt-4">
                            <div class="flex justify-between items-center">
                                <div class="text-sm text-gray-600">
                                    ${order.items.length} item(s) ‚Ä¢ ${order.items.map(item => `${item.name} x${item.quantity}`).join(', ')}
                                </div>
                                <div class="flex gap-2">
                                    ${order.status !== 'delivered' ? `
                                        <button onclick="showOrderTracking(${order.id})" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                            Track Order
                                        </button>
                                    ` : `
                                        <button onclick="reorder(${order.id})" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                            Reorder
                                        </button>
                                        <button onclick="showReviewModal(${order.id})" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors">
                                            Review
                                        </button>
                                    `}
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function reorder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            // Clear current cart and add items from the order
            cart = [...order.items];
            updateCartDisplay();
            updateCartCount();
            
            showNotification('Items added to cart!', 'success');
            toggleCart();
        }

        // Profile functions
        function loadProfile() {
            if (currentUser) {
                document.getElementById('profileName').value = currentUser.name || '';
                document.getElementById('profileEmail').value = currentUser.email || '';
                document.getElementById('profilePhone').value = currentUser.phone || '';
            }

            // Load saved addresses
            const addressesContainer = document.getElementById('savedAddresses');
            const addresses = [
                { id: 1, label: 'Home', address: '123 Main Street, City, 12345' },
                { id: 2, label: 'Work', address: '456 Business Ave, City, 12346' }
            ];

            addressesContainer.innerHTML = addresses.map(addr => `
                <div class="flex justify-between items-center p-3 border rounded-lg">
                    <div>
                        <div class="font-semibold">${addr.label}</div>
                        <div class="text-sm text-gray-600">${addr.address}</div>
                    </div>
                    <button class="text-red-600 hover:text-red-800">Remove</button>
                </div>
            `).join('');
        }

        // Vendor functions
        function showVendorPanel() {
            showSection('vendor');
        }

        function loadVendorDashboard() {
            // Load vendor menu items
            const menuContainer = document.getElementById('vendorMenuItems');
            const vendorMenu = restaurants[0].menu; // Using first restaurant as example

            menuContainer.innerHTML = vendorMenu.map(item => `
                <div class="flex justify-between items-center p-3 border rounded-lg">
                    <div>
                        <div class="font-semibold">${item.name}</div>
                        <div class="text-sm text-gray-600">‚Çπ${item.price}</div>
                    </div>
                    <div class="flex gap-2">
                        <button class="bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors">Edit</button>
                        <button class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors">Delete</button>
                    </div>
                </div>
            `).join('');

            // Load vendor orders
            const ordersContainer = document.getElementById('vendorOrders');
            const vendorOrders = orders.slice(0, 5); // Show recent orders

            ordersContainer.innerHTML = vendorOrders.map(order => `
                <div class="flex justify-between items-center p-3 border rounded-lg">
                    <div>
                        <div class="font-semibold">Order #${order.id}</div>
                        <div class="text-sm text-gray-600">‚Çπ${order.total} ‚Ä¢ ${order.items.length} items</div>
                    </div>
                    <select class="px-2 py-1 border rounded text-sm" onchange="updateOrderStatus(${order.id}, this.value)">
                        <option value="confirmed" ${order.status === 'confirmed' ? 'selected' : ''}>Confirmed</option>
                        <option value="preparing" ${order.status === 'preparing' ? 'selected' : ''}>Preparing</option>
                        <option value="ready" ${order.status === 'ready' ? 'selected' : ''}>Ready</option>
                        <option value="out_for_delivery" ${order.status === 'out_for_delivery' ? 'selected' : ''}>Out for Delivery</option>
                        <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Delivered</option>
                    </select>
                </div>
            `).join('');
        }

        function updateOrderStatus(orderId, newStatus) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                const oldStatus = order.status;
                order.status = newStatus;
                
                // Find the status element and animate it
                const statusElement = event.target;
                statusElement.classList.add('status-transition');
                setTimeout(() => statusElement.classList.remove('status-transition'), 800);
                
                // Show animated notification
                const statusLabels = {
                    'confirmed': 'Confirmed',
                    'preparing': 'Being Prepared',
                    'ready': 'Ready for Pickup',
                    'out_for_delivery': 'Out for Delivery',
                    'delivered': 'Delivered'
                };
                
                showNotification(`Order #${orderId} is now ${statusLabels[newStatus]}! üöÄ`, 'success');
                
                // Update tracking modal if open
                const trackingModal = document.getElementById('trackingModal');
                if (!trackingModal.classList.contains('hidden')) {
                    const trackingOrderId = document.getElementById('trackingOrderId').textContent;
                    if (trackingOrderId.includes(orderId)) {
                        updateTrackingDisplay(order);
                    }
                }
            }
        }

        function showAddItemModal() {
            showModal('addItemModal');
        }

        // Admin functions
        function showAdminPanel() {
            showSection('admin');
        }

        // Modal functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        function showLoginModal() {
            closeModal('registerModal');
            showModal('loginModal');
        }

        function showRegisterModal() {
            closeModal('loginModal');
            showModal('registerModal');
        }

        // Authentication functions
        function handleLogin(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const email = formData.get('email') || e.target.querySelector('input[type="email"]').value;
            
            // Simulate login
            currentUser = {
                id: 1,
                name: 'John Doe',
                email: email,
                phone: '+91 98765 43210'
            };
            
            document.getElementById('userName').textContent = currentUser.name;
            closeModal('loginModal');
            showRealTimeNotification('Welcome back! Login successful! üéâ', 'success');
            
            // Update personalized dashboard
            updatePersonalizedDashboard();
            
            // Award login bonus points
            awardLoyaltyPoints(25);
            
            // Show personalized welcome notification
            setTimeout(() => {
                showRealTimeNotification(`üçΩÔ∏è ${getPersonalizedWelcomeMessage()}`, 'info');
            }, 2000);
        }

        function handleRegister(e) {
            e.preventDefault();
            const inputs = e.target.querySelectorAll('input');
            
            // Simulate registration
            currentUser = {
                id: 1,
                name: inputs[0].value,
                email: inputs[1].value,
                phone: inputs[2].value
            };
            
            document.getElementById('userName').textContent = currentUser.name;
            closeModal('registerModal');
            showNotification('Registration successful!', 'success');
        }

        function handleProfileUpdate(e) {
            e.preventDefault();
            if (currentUser) {
                currentUser.name = document.getElementById('profileName').value;
                currentUser.email = document.getElementById('profileEmail').value;
                currentUser.phone = document.getElementById('profilePhone').value;
                
                document.getElementById('userName').textContent = currentUser.name;
                showNotification('Profile updated successfully!', 'success');
            }
        }

        function handleAddItem(e) {
            e.preventDefault();
            const inputs = e.target.querySelectorAll('input, textarea, select');
            
            const newItem = {
                id: Date.now(),
                name: inputs[0].value,
                description: inputs[1].value,
                price: parseInt(inputs[2].value),
                category: inputs[3].value
            };
            
            // Add to restaurant menu (using first restaurant as example)
            restaurants[0].menu.push(newItem);
            
            closeModal('addItemModal');
            loadVendorDashboard();
            showNotification('Menu item added successfully!', 'success');
            
            e.target.reset();
        }

        function logout() {
            currentUser = null;
            document.getElementById('userName').textContent = 'Guest';
            cart = [];
            updateCartDisplay();
            updateCartCount();
            showSection('home');
            showNotification('Logged out successfully!', 'info');
        }

        // Utility functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 px-6 py-3 rounded-lg text-white z-50 floating-notification shadow-lg ${
                type === 'success' ? 'bg-gradient-to-r from-green-500 to-emerald-600' : 
                type === 'error' ? 'bg-gradient-to-r from-red-500 to-pink-600' : 
                type === 'warning' ? 'bg-gradient-to-r from-yellow-500 to-orange-600' : 'bg-gradient-to-r from-blue-500 to-indigo-600'
            }`;
            
            // Add icon based on type
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <span class="text-lg">${icons[type] || icons.info}</span>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove with fade out animation
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease-out forwards';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 3000);
        }

        function filterRestaurants(searchTerm) {
            const filtered = restaurants.filter(restaurant => 
                restaurant.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                restaurant.cuisine.toLowerCase().includes(searchTerm.toLowerCase())
            );
            displayFilteredRestaurants(filtered);
        }

        function sortRestaurants(sortBy) {
            let sorted = [...restaurants];
            
            switch(sortBy) {
                case 'rating':
                    sorted.sort((a, b) => b.rating - a.rating);
                    break;
                case 'delivery':
                    sorted.sort((a, b) => parseInt(a.deliveryTime) - parseInt(b.deliveryTime));
                    break;
                case 'price':
                    sorted.sort((a, b) => a.deliveryFee - b.deliveryFee);
                    break;
            }
            
            displayFilteredRestaurants(sorted);
        }

        function showAddAddressModal() {
            showNotification('Add address functionality would be implemented here', 'info');
        }

        function showReviewModal(orderId) {
            showNotification('Review functionality would be implemented here', 'info');
        }

        // Dark mode functions
        function initializeDarkMode() {
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                updateDarkModeIcon(true);
            }
        }

        function toggleDarkMode() {
            const isDarkMode = document.documentElement.classList.contains('dark');
            
            if (isDarkMode) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('darkMode', 'false');
                updateDarkModeIcon(false);
                showNotification('Switched to light mode! ‚òÄÔ∏è', 'info');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('darkMode', 'true');
                updateDarkModeIcon(true);
                showNotification('Switched to dark mode! üåô', 'info');
            }
        }

        function updateDarkModeIcon(isDark) {
            const lightIcon = document.getElementById('lightIcon');
            const darkIcon = document.getElementById('darkIcon');
            
            if (isDark) {
                lightIcon.style.opacity = '0';
                lightIcon.style.transform = 'rotate(180deg)';
                darkIcon.style.opacity = '1';
                darkIcon.style.transform = 'rotate(0deg)';
            } else {
                lightIcon.style.opacity = '1';
                lightIcon.style.transform = 'rotate(0deg)';
                darkIcon.style.opacity = '0';
                darkIcon.style.transform = 'rotate(180deg)';
            }
        }

        // Smart Search & Filter Functions
        function showSearchSuggestions(query) {
            const suggestions = allSearchTerms.filter(term => 
                term.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 8);

            const suggestionsContainer = document.getElementById('searchSuggestions');
            
            if (suggestions.length > 0) {
                suggestionsContainer.innerHTML = suggestions.map(suggestion => `
                    <div class="p-3 hover:bg-gray-100 cursor-pointer border-b last:border-b-0 transition-colors" 
                         onclick="selectSuggestion('${suggestion}')">
                        <div class="flex items-center gap-3">
                            <span class="text-gray-400">üîç</span>
                            <span class="text-gray-800">${suggestion}</span>
                        </div>
                    </div>
                `).join('');
                suggestionsContainer.classList.remove('hidden');
            } else {
                hideSearchSuggestions();
            }
        }

        function hideSearchSuggestions() {
            document.getElementById('searchSuggestions').classList.add('hidden');
        }

        function selectSuggestion(suggestion) {
            document.getElementById('searchRestaurants').value = suggestion;
            hideSearchSuggestions();
            performSmartSearch(suggestion);
        }

        function performSmartSearch(query) {
            const filtered = restaurants.filter(restaurant => {
                const matchesName = restaurant.name.toLowerCase().includes(query.toLowerCase());
                const matchesCuisine = restaurant.cuisine.toLowerCase().includes(query.toLowerCase());
                const matchesTags = restaurant.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase()));
                const matchesMenu = restaurant.menu.some(item => 
                    item.name.toLowerCase().includes(query.toLowerCase()) ||
                    item.description.toLowerCase().includes(query.toLowerCase())
                );
                
                return matchesName || matchesCuisine || matchesTags || matchesMenu;
            });

            displayFilteredRestaurants(filtered);
            
            if (filtered.length === 0) {
                showNoResultsMessage(query);
            }
        }

        function showNoResultsMessage(query) {
            const container = document.getElementById('restaurantsList');
            container.innerHTML = `
                <div class="col-span-full text-center py-12">
                    <div class="text-6xl mb-4">üîç</div>
                    <h3 class="text-xl font-semibold mb-2">No results found for "${query}"</h3>
                    <p class="text-gray-600 mb-6">Try searching for something else or browse our popular restaurants</p>
                    <button onclick="clearSearch()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        Clear Search
                    </button>
                </div>
            `;
        }

        function clearSearch() {
            document.getElementById('searchRestaurants').value = '';
            hideSearchSuggestions();
            loadRestaurants();
        }

        function toggleFilter(filterType) {
            const button = document.getElementById(`filter${filterType.charAt(0).toUpperCase() + filterType.slice(1)}`);
            
            if (activeFilters.includes(filterType)) {
                // Remove filter
                activeFilters = activeFilters.filter(f => f !== filterType);
                button.classList.remove('bg-blue-600', 'text-white');
                button.classList.add('border', 'hover:bg-gray-100');
            } else {
                // Add filter
                activeFilters.push(filterType);
                button.classList.add('bg-blue-600', 'text-white');
                button.classList.remove('border', 'hover:bg-gray-100');
            }
            
            applyFilters();
        }

        function applyFilters() {
            let filtered = [...restaurants];
            
            activeFilters.forEach(filter => {
                switch(filter) {
                    case 'veg':
                        filtered = filtered.filter(r => r.isVeg || r.menu.some(item => item.isVeg));
                        break;
                    case 'nonveg':
                        filtered = filtered.filter(r => !r.isVeg || r.menu.some(item => !item.isVeg));
                        break;
                    case 'offers':
                        filtered = filtered.filter(r => r.hasOffers);
                        break;
                    case 'fast':
                        filtered = filtered.filter(r => r.isFastDelivery);
                        break;
                    case 'toprated':
                        filtered = filtered.filter(r => r.rating >= 4.5);
                        break;
                }
            });
            
            displayFilteredRestaurants(filtered);
        }

        // Enhanced sorting with new criteria
        function sortRestaurants(sortBy) {
            let sorted = [...restaurants];
            
            switch(sortBy) {
                case 'popularity':
                    sorted.sort((a, b) => b.popularity - a.popularity);
                    break;
                case 'rating':
                    sorted.sort((a, b) => b.rating - a.rating);
                    break;
                case 'delivery':
                    sorted.sort((a, b) => parseInt(a.deliveryTime) - parseInt(b.deliveryTime));
                    break;
                case 'price':
                    sorted.sort((a, b) => a.deliveryFee - b.deliveryFee);
                    break;
                case 'distance':
                    sorted.sort((a, b) => a.distance - b.distance);
                    break;
            }
            
            displayFilteredRestaurants(sorted);
        }

        // Personalized Dashboard Functions
        function initializeUserPreferences() {
            // Initialize with sample data
            userPreferences.favoriteItems = [
                { id: 1, name: "Margherita Pizza", restaurant: "Pizza Palace", orderCount: 5 },
                { id: 7, name: "Butter Chicken", restaurant: "Spice Garden", orderCount: 3 },
                { id: 4, name: "Classic Burger", restaurant: "Burger Hub", orderCount: 4 }
            ];
            
            userPreferences.orderHistory = [
                { restaurantId: 1, items: [1, 2], timestamp: new Date(Date.now() - 86400000) },
                { restaurantId: 3, items: [7, 8], timestamp: new Date(Date.now() - 172800000) },
                { restaurantId: 2, items: [4, 6], timestamp: new Date(Date.now() - 259200000) }
            ];
        }

        function updatePersonalizedDashboard() {
            if (currentUser) {
                document.getElementById('personalizedDashboard').classList.remove('hidden');
                document.getElementById('guestHero').classList.add('hidden');
                
                // Update user name and loyalty points
                document.getElementById('dashboardUserName').textContent = currentUser.name;
                document.getElementById('loyaltyPoints').textContent = userPreferences.loyaltyPoints.toLocaleString();
                
                // Update current order widget
                updateCurrentOrderWidget();
                
                // Load favorite dishes
                loadFavoriteDishes();
                
                // Load AI recommendations
                loadAIRecommendations();
                
                // Load quick reorder items
                loadQuickReorderItems();
            } else {
                document.getElementById('personalizedDashboard').classList.add('hidden');
                document.getElementById('guestHero').classList.remove('hidden');
            }
        }

        function updateCurrentOrderWidget() {
            const activeOrder = orders.find(order => order.status !== 'delivered');
            const container = document.getElementById('currentOrderContent');
            
            if (activeOrder) {
                container.innerHTML = `
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="font-semibold">Order #${activeOrder.id}</span>
                            <span class="px-2 py-1 rounded-full text-xs ${getStatusColor(activeOrder.status)}">
                                ${activeOrder.status.replace('_', ' ').toUpperCase()}
                            </span>
                        </div>
                        <div class="text-sm text-gray-600">${activeOrder.restaurant}</div>
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-bold">‚Çπ${activeOrder.total}</span>
                            <button onclick="showOrderTracking(${activeOrder.id})" 
                                    class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors">
                                Track
                            </button>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">No active orders</p>';
            }
        }

        function loadFavoriteDishes() {
            const container = document.getElementById('favoriteDishes');
            
            container.innerHTML = userPreferences.favoriteItems.slice(0, 3).map(item => `
                <div class="flex justify-between items-center p-2 border rounded-lg hover:bg-gray-50 transition-colors">
                    <div class="flex-1">
                        <div class="font-semibold text-sm">${item.name}</div>
                        <div class="text-xs text-gray-600">${item.restaurant}</div>
                    </div>
                    <button onclick="quickAddToCart(${item.id})" 
                            class="bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700 transition-colors">
                        Add
                    </button>
                </div>
            `).join('');
        }

        function loadAIRecommendations() {
            // Simple rule-based recommendation system
            const recommendations = generateRecommendations();
            const container = document.getElementById('aiRecommendations');
            
            container.innerHTML = recommendations.slice(0, 3).map(item => `
                <div class="flex justify-between items-center p-2 border rounded-lg hover:bg-gray-50 transition-colors">
                    <div class="flex-1">
                        <div class="font-semibold text-sm">${item.name}</div>
                        <div class="text-xs text-gray-600">${item.restaurant} ‚Ä¢ ${item.reason}</div>
                    </div>
                    <button onclick="quickAddToCart(${item.id})" 
                            class="bg-purple-600 text-white px-2 py-1 rounded text-xs hover:bg-purple-700 transition-colors">
                        Try
                    </button>
                </div>
            `).join('');
        }

        function generateRecommendations() {
            const allItems = restaurants.flatMap(r => 
                r.menu.map(item => ({...item, restaurant: r.name, restaurantId: r.id}))
            );
            
            // Rule-based recommendations
            const recommendations = [];
            
            // Popular items not yet tried
            const popularItems = allItems.filter(item => 
                item.isPopular && 
                !userPreferences.favoriteItems.some(fav => fav.id === item.id)
            );
            
            recommendations.push(...popularItems.slice(0, 2).map(item => ({
                ...item,
                reason: "Popular choice"
            })));
            
            // Items from favorite restaurants
            const favoriteRestaurants = [...new Set(userPreferences.favoriteItems.map(item => item.restaurant))];
            const restaurantRecommendations = allItems.filter(item => 
                favoriteRestaurants.includes(item.restaurant) &&
                !userPreferences.favoriteItems.some(fav => fav.id === item.id)
            );
            
            recommendations.push(...restaurantRecommendations.slice(0, 1).map(item => ({
                ...item,
                reason: "From favorite restaurant"
            })));
            
            return recommendations;
        }

        function loadQuickReorderItems() {
            const container = document.getElementById('quickReorderItems');
            const recentOrders = orders.slice(0, 3);
            
            container.innerHTML = recentOrders.map(order => `
                <div class="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors cursor-pointer" 
                     onclick="reorder(${order.id})">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-semibold">${order.restaurant}</h4>
                        <span class="text-sm text-gray-500">‚Çπ${order.total}</span>
                    </div>
                    <div class="text-sm text-gray-600 mb-3">
                        ${order.items.slice(0, 2).map(item => item.name).join(', ')}
                        ${order.items.length > 2 ? ` +${order.items.length - 2} more` : ''}
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-xs text-gray-500">
                            ${order.timestamp.toLocaleDateString()}
                        </span>
                        <button class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors">
                            Reorder
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function quickAddToCart(itemId) {
            // Find item across all restaurants
            let foundItem = null;
            let foundRestaurant = null;
            
            for (const restaurant of restaurants) {
                const item = restaurant.menu.find(menuItem => menuItem.id === itemId);
                if (item) {
                    foundItem = item;
                    foundRestaurant = restaurant;
                    break;
                }
            }
            
            if (foundItem && foundRestaurant) {
                currentRestaurant = foundRestaurant;
                addToCart(itemId);
                
                // Add to favorites if not already there
                if (!userPreferences.favoriteItems.some(fav => fav.id === itemId)) {
                    userPreferences.favoriteItems.push({
                        id: itemId,
                        name: foundItem.name,
                        restaurant: foundRestaurant.name,
                        orderCount: 1
                    });
                }
                
                // Award loyalty points
                awardLoyaltyPoints(10);
            }
        }

        function awardLoyaltyPoints(points) {
            userPreferences.loyaltyPoints += points;
            document.getElementById('loyaltyPoints').textContent = userPreferences.loyaltyPoints.toLocaleString();
            
            // Update progress bar
            const progress = (userPreferences.loyaltyPoints % 1500) / 1500 * 100;
            document.getElementById('loyaltyProgressBar').style.width = `${progress}%`;
            document.getElementById('loyaltyProgress').textContent = `${Math.round(progress)}%`;
            
            showRealTimeNotification(`üéâ You earned ${points} loyalty points!`, 'success');
        }

        // Real-time Notifications System
        function initializeRealTimeNotifications() {
            // Simulate WebSocket connection
            realTimeSocket = {
                connected: true,
                send: function(data) {
                    console.log('Sending:', data);
                },
                onMessage: function(callback) {
                    // Simulate receiving messages
                    setInterval(() => {
                        if (Math.random() < 0.1) { // 10% chance every interval
                            callback({
                                type: 'order_update',
                                message: 'Your order status has been updated!',
                                timestamp: new Date()
                            });
                        }
                    }, 10000); // Check every 10 seconds
                }
            };
            
            // Listen for real-time updates
            realTimeSocket.onMessage(handleRealTimeMessage);
        }

        function handleRealTimeMessage(data) {
            switch(data.type) {
                case 'order_update':
                    showRealTimeNotification(data.message, 'info');
                    break;
                case 'promotion':
                    showRealTimeNotification(data.message, 'success');
                    break;
                case 'delivery_update':
                    showRealTimeNotification(data.message, 'warning');
                    break;
            }
        }

        function showRealTimeNotification(message, type = 'info', persistent = false) {
            const notification = {
                id: Date.now(),
                message: message,
                type: type,
                timestamp: new Date(),
                read: false
            };
            
            notifications.unshift(notification);
            updateNotificationBadge();
            
            // Show floating notification
            const floatingNotification = document.createElement('div');
            floatingNotification.className = `bg-white border-l-4 rounded-lg shadow-lg p-4 mb-2 floating-notification ${
                type === 'success' ? 'border-green-500' : 
                type === 'error' ? 'border-red-500' : 
                type === 'warning' ? 'border-yellow-500' : 'border-blue-500'
            }`;
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            floatingNotification.innerHTML = `
                <div class="flex items-start gap-3">
                    <span class="text-lg">${icons[type] || icons.info}</span>
                    <div class="flex-1">
                        <div class="text-sm font-medium text-gray-800">${message}</div>
                        <div class="text-xs text-gray-500">${notification.timestamp.toLocaleTimeString()}</div>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-gray-400 hover:text-gray-600">
                        ‚úï
                    </button>
                </div>
            `;
            
            document.getElementById('notificationContainer').appendChild(floatingNotification);
            
            // Auto remove if not persistent
            if (!persistent) {
                setTimeout(() => {
                    if (floatingNotification.parentNode) {
                        floatingNotification.style.animation = 'fadeOut 0.3s ease-out forwards';
                        setTimeout(() => floatingNotification.remove(), 300);
                    }
                }, 5000);
            }
            
            updateNotificationsList();
        }

        function toggleNotifications() {
            const dropdown = document.getElementById('notificationsDropdown');
            dropdown.classList.toggle('hidden');
            
            if (!dropdown.classList.contains('hidden')) {
                // Mark notifications as read
                notifications.forEach(n => n.read = true);
                updateNotificationBadge();
                updateNotificationsList();
            }
        }

        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        function updateNotificationsList() {
            const container = document.getElementById('notificationsList');
            
            if (notifications.length === 0) {
                container.innerHTML = '<div class="p-4 text-center text-gray-500">No new notifications</div>';
                return;
            }
            
            container.innerHTML = notifications.slice(0, 10).map(notification => `
                <div class="p-4 hover:bg-gray-50 transition-colors ${!notification.read ? 'bg-blue-50' : ''}">
                    <div class="flex items-start gap-3">
                        <span class="text-lg">${
                            notification.type === 'success' ? '‚úÖ' : 
                            notification.type === 'error' ? '‚ùå' : 
                            notification.type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è'
                        }</span>
                        <div class="flex-1">
                            <div class="text-sm font-medium text-gray-800">${notification.message}</div>
                            <div class="text-xs text-gray-500">${notification.timestamp.toLocaleString()}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function clearAllNotifications() {
            notifications = [];
            updateNotificationBadge();
            updateNotificationsList();
            
            // Clear floating notifications
            document.getElementById('notificationContainer').innerHTML = '';
        }

        function getPersonalizedWelcomeMessage() {
            const messages = [
                "Your favorite Margherita Pizza is available at Pizza Palace!",
                "New healthy options added at Green Bowl - check them out!",
                "Spice Garden has a special offer on Biryani today!",
                "Fast delivery available from Burger Hub in your area!",
                "You're just 250 points away from your next reward!"
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        // Enhanced order placement with gamification
        function placeOrder() {
            const orderId = Date.now();
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal + 40; // delivery fee

            const order = {
                id: orderId,
                items: [...cart],
                restaurant: currentRestaurant.name,
                total: total,
                status: 'confirmed',
                timestamp: new Date(),
                estimatedDelivery: new Date(Date.now() + 30 * 60000) // 30 minutes
            };

            orders.unshift(order);
            
            // Award loyalty points for order
            const pointsEarned = Math.floor(total / 10); // 1 point per ‚Çπ10
            awardLoyaltyPoints(pointsEarned);
            
            // Update user preferences
            cart.forEach(item => {
                const existingFav = userPreferences.favoriteItems.find(fav => fav.id === item.id);
                if (existingFav) {
                    existingFav.orderCount++;
                } else {
                    userPreferences.favoriteItems.push({
                        id: item.id,
                        name: item.name,
                        restaurant: currentRestaurant.name,
                        orderCount: 1
                    });
                }
            });
            
            cart = [];
            
            updateCartDisplay();
            updateCartCount();
            closeModal('checkoutModal');
            
            showRealTimeNotification(`üéâ Order placed successfully! You earned ${pointsEarned} points!`, 'success');
            
            // Start order tracking
            setTimeout(() => {
                showOrderTracking(orderId);
            }, 1000);

            // Simulate order status updates with notifications
            simulateOrderProgressWithNotifications(orderId);
            
            // Update dashboard
            updatePersonalizedDashboard();
        }

        function simulateOrderProgressWithNotifications(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const statuses = [
                { status: 'confirmed', message: 'üõí Order confirmed! Restaurant is preparing your food.', delay: 0 },
                { status: 'preparing', message: 'üç≥ Your delicious meal is being prepared!', delay: 5000 },
                { status: 'ready', message: 'üì¶ Food is ready! Delivery partner assigned.', delay: 15000 },
                { status: 'out_for_delivery', message: 'üö¥ Your order is on the way! Track live location.', delay: 25000 },
                { status: 'delivered', message: '‚úÖ Order delivered! Enjoy your meal! üéâ', delay: 45000 }
            ];

            statuses.forEach((statusUpdate, index) => {
                setTimeout(() => {
                    order.status = statusUpdate.status;
                    showRealTimeNotification(statusUpdate.message, 'info');
                    
                    // Update tracking modal if open
                    const modal = document.getElementById('trackingModal');
                    if (!modal.classList.contains('hidden')) {
                        updateTrackingDisplay(order);
                        startLiveTracking(order);
                    }
                    
                    // Update dashboard current order widget
                    updateCurrentOrderWidget();
                    
                    // Award bonus points for completion
                    if (statusUpdate.status === 'delivered') {
                        awardLoyaltyPoints(50);
                        setTimeout(() => {
                            showRealTimeNotification('üåü Rate your experience and earn 25 bonus points!', 'success');
                        }, 3000);
                    }
                }, statusUpdate.delay);
            });
        }

        // ==================== SMART OFFERS CAROUSEL ====================
        
        function initializeSmartOffers() {
            loadOffersCarousel();
        }

        function loadOffersCarousel() {
            const carousel = document.getElementById('offersCarousel');
            const indicators = document.getElementById('carouselIndicators');
            
            // Create offer cards
            carousel.innerHTML = smartOffers.map((offer, index) => `
                <div class="offer-card bg-gradient-to-br ${offer.gradient} relative" data-offer-index="${index}">
                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <div class="text-4xl mb-2">${offer.emoji}</div>
                                <h3 class="text-2xl font-bold mb-1">${offer.title}</h3>
                                <p class="text-lg opacity-90">${offer.subtitle}</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-lg px-3 py-2">
                                <div class="text-lg font-bold">${offer.discount}</div>
                            </div>
                        </div>
                        
                        <p class="text-sm opacity-80 mb-4">${offer.description}</p>
                        
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-sm opacity-75">Valid until</div>
                                <div class="font-semibold">${offer.validUntil}</div>
                            </div>
                            <button onclick="applyOffer('${offer.code}')" 
                                    class="bg-white text-gray-800 px-6 py-2 rounded-lg font-semibold hover:bg-opacity-90 transition-all duration-300 hover:scale-105">
                                Claim Now
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Create indicators
            indicators.innerHTML = smartOffers.map((_, index) => `
                <div class="carousel-indicator ${index === 0 ? 'active' : ''}" 
                     onclick="goToOffer(${index})"></div>
            `).join('');
        }

        function startOfferCarousel() {
            offerCarouselInterval = setInterval(() => {
                nextOffer();
            }, 5000); // Auto-advance every 5 seconds
        }

        function stopOfferCarousel() {
            if (offerCarouselInterval) {
                clearInterval(offerCarouselInterval);
                offerCarouselInterval = null;
            }
        }

        function nextOffer() {
            currentOfferIndex = (currentOfferIndex + 1) % smartOffers.length;
            updateCarouselPosition();
        }

        function prevOffer() {
            currentOfferIndex = (currentOfferIndex - 1 + smartOffers.length) % smartOffers.length;
            updateCarouselPosition();
        }

        function goToOffer(index) {
            currentOfferIndex = index;
            updateCarouselPosition();
            
            // Restart auto-advance
            stopOfferCarousel();
            startOfferCarousel();
        }

        function updateCarouselPosition() {
            const carousel = document.getElementById('offersCarousel');
            const indicators = document.querySelectorAll('.carousel-indicator');
            
            carousel.style.transform = `translateX(-${currentOfferIndex * 100}%)`;
            
            // Update indicators
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentOfferIndex);
            });
        }

        function applyOffer(code) {
            showRealTimeNotification(`üéâ Offer ${code} applied! Check restaurants for discounted items.`, 'success');
            
            // Simulate applying offer to cart
            if (cart.length > 0) {
                const discount = Math.floor(Math.random() * 100) + 50; // Random discount 50-150
                showRealTimeNotification(`üí∞ You saved ‚Çπ${discount} with this offer!`, 'success');
            } else {
                showRealTimeNotification(`üõí Add items to cart to see your savings!`, 'info');
            }
        }

        function showAllOffers() {
            showRealTimeNotification('üìã All offers page would open here!', 'info');
        }

        // ==================== QR CODE SYSTEM ====================
        
        function initializeQRDatabase() {
            // Pre-populate with demo QR codes
            qrOrderDatabase = {
                'QR-PIZZA-001': {
                    restaurant: 'Pizza Palace',
                    items: [
                        { id: 1, name: 'Margherita Pizza', price: 299, quantity: 1 },
                        { id: 3, name: 'Garlic Bread', price: 149, quantity: 1 }
                    ],
                    total: 448
                },
                'QR-BURGER-002': {
                    restaurant: 'Burger Hub',
                    items: [
                        { id: 4, name: 'Classic Burger', price: 199, quantity: 2 },
                        { id: 6, name: 'French Fries', price: 99, quantity: 1 }
                    ],
                    total: 497
                },
                'QR-INDIAN-003': {
                    restaurant: 'Spice Garden',
                    items: [
                        { id: 7, name: 'Butter Chicken', price: 349, quantity: 1 },
                        { id: 8, name: 'Biryani', price: 299, quantity: 1 },
                        { id: 9, name: 'Naan', price: 49, quantity: 2 }
                    ],
                    total: 746
                }
            };
        }

        function generateQRCode(orderId, orderData) {
            const qrId = `QR-${orderId}`;
            qrOrderDatabase[qrId] = orderData;
            
            // Generate visual QR code on canvas
            const canvas = document.getElementById('qrCodeCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, 200, 200);
            
            // Create QR code pattern (simplified visual representation)
            ctx.fillStyle = '#000000';
            
            // Generate random pattern that looks like QR code
            const gridSize = 10;
            const cellSize = 200 / gridSize;
            
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    // Create pattern based on order ID for consistency
                    const hash = (orderId * (i + 1) * (j + 1)) % 7;
                    if (hash < 3) {
                        ctx.fillRect(i * cellSize, j * cellSize, cellSize - 1, cellSize - 1);
                    }
                }
            }
            
            // Add corner markers
            ctx.fillRect(0, 0, cellSize * 3, cellSize * 3);
            ctx.fillRect((gridSize - 3) * cellSize, 0, cellSize * 3, cellSize * 3);
            ctx.fillRect(0, (gridSize - 3) * cellSize, cellSize * 3, cellSize * 3);
            
            // Add white squares in corners
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(cellSize, cellSize, cellSize, cellSize);
            ctx.fillRect((gridSize - 2) * cellSize, cellSize, cellSize, cellSize);
            ctx.fillRect(cellSize, (gridSize - 2) * cellSize, cellSize, cellSize);
            
            return qrId;
        }

        function showQRInvoice(orderId, orderData) {
            const qrId = generateQRCode(orderId, orderData);
            
            document.getElementById('qrOrderDetails').textContent = `Order #${orderId} ‚Ä¢ ‚Çπ${orderData.total}`;
            document.getElementById('qrCodeId').textContent = qrId;
            
            showModal('qrInvoiceModal');
        }

        function showQRScanner() {
            showModal('qrScannerModal');
        }

        function processManualQR() {
            const qrCode = document.getElementById('manualQRInput').value.trim().toUpperCase();
            simulateQRScan(qrCode);
        }

        function simulateQRScan(qrCode) {
            const orderData = qrOrderDatabase[qrCode];
            
            if (orderData) {
                closeModal('qrScannerModal');
                
                // Find the restaurant
                const restaurant = restaurants.find(r => r.name === orderData.restaurant);
                if (restaurant) {
                    currentRestaurant = restaurant;
                    
                    // Clear current cart and add items from QR
                    cart = [...orderData.items];
                    updateCartDisplay();
                    updateCartCount();
                    
                    showRealTimeNotification(`üéâ QR Code scanned! ${orderData.items.length} items added to cart from ${orderData.restaurant}`, 'success');
                    
                    // Show menu section
                    showRestaurantMenu(restaurant.id);
                    
                    // Auto-open cart
                    setTimeout(() => {
                        toggleCart();
                    }, 1000);
                } else {
                    showRealTimeNotification('‚ùå Restaurant not found for this QR code', 'error');
                }
            } else {
                showRealTimeNotification('‚ùå Invalid QR code. Please try again.', 'error');
            }
            
            // Clear input
            document.getElementById('manualQRInput').value = '';
        }

        function downloadQRCode() {
            const canvas = document.getElementById('qrCodeCanvas');
            const link = document.createElement('a');
            link.download = `order-qr-${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
            
            showRealTimeNotification('üì± QR Code saved to downloads!', 'success');
        }

        function shareOrder() {
            const orderDetails = document.getElementById('qrOrderDetails').textContent;
            const qrId = document.getElementById('qrCodeId').textContent;
            
            if (navigator.share) {
                navigator.share({
                    title: 'FoodFlow Order',
                    text: `Check out my order: ${orderDetails}. QR Code: ${qrId}`,
                    url: window.location.href
                });
            } else {
                // Fallback for browsers without Web Share API
                const shareText = `Check out my FoodFlow order: ${orderDetails}. QR Code: ${qrId}`;
                navigator.clipboard.writeText(shareText).then(() => {
                    showRealTimeNotification('üìã Order details copied to clipboard!', 'success');
                });
            }
        }

        function trackOrder() {
            closeModal('qrInvoiceModal');
            const activeOrder = orders.find(order => order.status !== 'delivered');
            if (activeOrder) {
                showOrderTracking(activeOrder.id);
            } else {
                showRealTimeNotification('üìç No active orders to track', 'info');
            }
        }

        // ==================== ENHANCED LIVE TRACKING ====================
        
        function startLiveTracking(order) {
            if (liveTrackingInterval) {
                clearInterval(liveTrackingInterval);
            }
            
            deliveryProgress = 0;
            
            liveTrackingInterval = setInterval(() => {
                deliveryProgress += Math.random() * 5 + 2; // Progress 2-7% each update
                
                if (deliveryProgress >= 100) {
                    deliveryProgress = 100;
                    clearInterval(liveTrackingInterval);
                }
                
                updateLiveTrackingDisplay(order, deliveryProgress);
            }, 2000); // Update every 2 seconds
        }

        function updateLiveTrackingDisplay(order, progress) {
            // Update delivery vehicle position
            const vehicle = document.getElementById('deliveryVehicle');
            if (vehicle) {
                const startX = 30;
                const endX = 370;
                const currentX = startX + (endX - startX) * (progress / 100);
                
                // Calculate Y position based on route
                let currentY = 100;
                if (progress > 25 && progress <= 50) {
                    currentY = 70; // Moving up
                } else if (progress > 75) {
                    currentY = 130; // Moving down to destination
                }
                
                vehicle.style.transform = `translate(${currentX}px, ${currentY}px)`;
            }
            
            // Update GPS trail
            const trail = document.getElementById('gpsTrail');
            if (trail) {
                const pathLength = 340; // Approximate path length
                const currentLength = pathLength * (progress / 100);
                trail.style.strokeDasharray = `${currentLength}, ${pathLength}`;
            }
            
            // Update progress indicators
            const progressBar = document.getElementById('mapProgressBar');
            const progressText = document.getElementById('deliveryProgress');
            const distanceElement = document.getElementById('distanceRemaining');
            const etaElement = document.getElementById('etaRemaining');
            
            if (progressBar) progressBar.style.width = `${progress}%`;
            if (progressText) progressText.textContent = `${Math.round(progress)}%`;
            
            // Update distance and ETA based on progress
            const remainingDistance = Math.max(0, 2.5 - (2.5 * progress / 100));
            const remainingTime = Math.max(0, 25 - (25 * progress / 100));
            
            if (distanceElement) distanceElement.textContent = `${remainingDistance.toFixed(1)} km away`;
            if (etaElement) etaElement.textContent = `${Math.round(remainingTime)} mins`;
            
            // Update rider status
            const riderStatus = document.getElementById('riderStatus');
            if (riderStatus) {
                const statusMessages = [
                    'Starting journey...',
                    'Picked up your order...',
                    'On the main road...',
                    'Navigating through traffic...',
                    'Almost there...',
                    'Arriving at your location!'
                ];
                
                const messageIndex = Math.min(Math.floor(progress / 20), statusMessages.length - 1);
                riderStatus.textContent = statusMessages[messageIndex];
            }
        }

        // LinkedIn Profile Function
        function openLinkedInProfile() {
            window.open('https://www.linkedin.com/in/anchal-pandey-2ba90b215/', '_blank');
            showRealTimeNotification('üîó Opening LinkedIn profile...', 'info');
        }

        // ==================== REAL QR SCANNER FUNCTIONS ====================
        
        function showQRScanner() {
            showModal('qrScannerModal');
            showCameraSection();
            initializeQRScanner();
        }

        function closeQRScanner() {
            stopQRScanner();
            closeModal('qrScannerModal');
        }

        function showCameraSection() {
            document.getElementById('cameraSection').classList.remove('hidden');
            document.getElementById('fallbackSection').classList.add('hidden');
        }

        function showFallbackSection() {
            stopQRScanner();
            document.getElementById('cameraSection').classList.add('hidden');
            document.getElementById('fallbackSection').classList.remove('hidden');
        }

        async function initializeQRScanner() {
            try {
                updateScannerStatus('Initializing camera...');
                
                // Check if Html5Qrcode is available
                if (typeof Html5Qrcode === 'undefined') {
                    throw new Error('QR Scanner library not loaded');
                }

                // Get available cameras
                const devices = await Html5Qrcode.getCameras();
                availableCameras = devices;
                
                if (devices && devices.length > 0) {
                    updateScannerStatus(`Found ${devices.length} camera(s). Click Start Scanner to begin.`);
                    updateCameraInfo(`${devices.length} camera(s) available`);
                    
                    // Show switch camera button if multiple cameras
                    if (devices.length > 1) {
                        document.getElementById('switchCameraBtn').classList.remove('hidden');
                    }
                } else {
                    throw new Error('No cameras found on this device');
                }
                
            } catch (error) {
                console.error('QR Scanner initialization error:', error);
                updateScannerStatus('Camera initialization failed. Try manual entry.');
                showRealTimeNotification('üì∑ Camera not available. Use manual entry instead.', 'warning');
                
                setTimeout(() => {
                    showFallbackSection();
                }, 2000);
            }
        }

        async function startQRScanner() {
            try {
                if (isQRScannerRunning) {
                    showRealTimeNotification('üì∑ Scanner already running', 'info');
                    return;
                }

                updateScannerStatus('Starting camera...');
                
                // Initialize Html5Qrcode if not already done
                if (!html5QrCode) {
                    html5QrCode = new Html5Qrcode("qr-reader");
                }

                // Use the first available camera or the current one
                currentCameraId = currentCameraId || (availableCameras[0] ? availableCameras[0].id : null);
                
                if (!currentCameraId) {
                    throw new Error('No camera available');
                }

                // Configuration for the scanner
                const config = {
                    fps: 10,    // Frames per second
                    qrbox: { width: 250, height: 250 },  // QR code scanning box
                    aspectRatio: 1.0,
                    disableFlip: false
                };

                // Start scanning
                await html5QrCode.start(
                    currentCameraId,
                    config,
                    onQRScanSuccess,
                    onQRScanFailure
                );

                isQRScannerRunning = true;
                updateScannerStatus('üì∑ Scanner active - Point at QR code');
                updateCameraInfo(`Camera: ${getCurrentCameraName()}`);
                
                // Update button states
                document.getElementById('startScanBtn').classList.add('hidden');
                document.getElementById('stopScanBtn').classList.remove('hidden');
                
                showRealTimeNotification('üì∑ QR Scanner started successfully!', 'success');

            } catch (error) {
                console.error('QR Scanner start error:', error);
                let errorMessage = 'Failed to start camera';
                
                if (error.name === 'NotAllowedError') {
                    errorMessage = 'Camera permission denied. Please allow camera access and refresh the page.';
                } else if (error.name === 'NotFoundError') {
                    errorMessage = 'Camera not found. Please check your device.';
                } else if (error.message.includes('Permission')) {
                    errorMessage = 'Camera permission required. Please allow access and try again.';
                }
                
                updateScannerStatus(errorMessage);
                showRealTimeNotification(`üì∑ ${errorMessage}`, 'error');
                
                // Reset button states
                document.getElementById('startScanBtn').classList.remove('hidden');
                document.getElementById('stopScanBtn').classList.add('hidden');
            }
        }

        async function stopQRScanner() {
            try {
                if (html5QrCode && isQRScannerRunning) {
                    await html5QrCode.stop();
                    isQRScannerRunning = false;
                    updateScannerStatus('Scanner stopped');
                    updateCameraInfo('Camera: Stopped');
                    
                    // Update button states
                    document.getElementById('startScanBtn').classList.remove('hidden');
                    document.getElementById('stopScanBtn').classList.add('hidden');
                    
                    showRealTimeNotification('üì∑ QR Scanner stopped', 'info');
                }
            } catch (error) {
                console.error('Error stopping QR scanner:', error);
                isQRScannerRunning = false;
                
                // Force reset button states
                document.getElementById('startScanBtn').classList.remove('hidden');
                document.getElementById('stopScanBtn').classList.add('hidden');
            }
        }

        async function switchQRCamera() {
            if (!availableCameras || availableCameras.length <= 1) {
                showRealTimeNotification('üì∑ No other cameras available', 'warning');
                return;
            }

            try {
                // Stop current scanner
                if (isQRScannerRunning) {
                    await stopQRScanner();
                }

                // Switch to next camera
                const currentIndex = availableCameras.findIndex(camera => camera.id === currentCameraId);
                const nextIndex = (currentIndex + 1) % availableCameras.length;
                currentCameraId = availableCameras[nextIndex].id;

                // Start with new camera
                setTimeout(() => {
                    startQRScanner();
                }, 500);

                const cameraName = getCurrentCameraName();
                showRealTimeNotification(`üì∑ Switched to ${cameraName}`, 'info');

            } catch (error) {
                console.error('Error switching camera:', error);
                showRealTimeNotification('üì∑ Failed to switch camera', 'error');
            }
        }

        function getCurrentCameraName() {
            if (!currentCameraId || !availableCameras) return 'Unknown';
            
            const camera = availableCameras.find(cam => cam.id === currentCameraId);
            if (camera && camera.label) {
                // Simplify camera name
                if (camera.label.toLowerCase().includes('back')) return 'Back Camera';
                if (camera.label.toLowerCase().includes('front')) return 'Front Camera';
                if (camera.label.toLowerCase().includes('environment')) return 'Back Camera';
                if (camera.label.toLowerCase().includes('user')) return 'Front Camera';
                return camera.label.substring(0, 20) + '...';
            }
            return 'Camera';
        }

        function updateScannerStatus(message) {
            const statusElement = document.getElementById('scannerStatusText');
            if (statusElement) {
                statusElement.textContent = message;
            }
        }

        function updateCameraInfo(message) {
            const infoElement = document.getElementById('cameraInfo');
            if (infoElement) {
                infoElement.textContent = message;
            }
        }

        // QR Code scan success callback
        function onQRScanSuccess(decodedText, decodedResult) {
            console.log('QR Code detected:', decodedText);
            
            // Stop scanner immediately to prevent multiple scans
            stopQRScanner();
            
            // Update status
            updateScannerStatus('‚úÖ QR Code detected! Processing...');
            
            // Process the scanned QR code
            setTimeout(() => {
                processScannedQR(decodedText);
            }, 500);
        }

        // QR Code scan failure callback (optional)
        function onQRScanFailure(error) {
            // This is called when no QR code is found in the frame
            // We don't need to do anything here as it's normal behavior
        }

        function processScannedQR(qrText) {
            // Clean and format the QR text
            const qrCode = qrText.trim().toUpperCase();
            
            // Check if it's one of our order QR codes
            if (qrCode.startsWith('QR-') && qrOrderDatabase[qrCode]) {
                simulateQRScan(qrCode);
            } else if (qrCode.includes('linkedin.com')) {
                // Handle LinkedIn QR codes
                closeQRScanner();
                showRealTimeNotification('üîó LinkedIn profile detected! Opening...', 'info');
                setTimeout(() => {
                    window.open(qrCode, '_blank');
                }, 1000);
            } else if (qrCode.startsWith('HTTP') || qrCode.startsWith('HTTPS')) {
                // Handle general URLs
                closeQRScanner();
                showRealTimeNotification('üåê URL detected! Opening...', 'info');
                setTimeout(() => {
                    window.open(qrCode, '_blank');
                }, 1000);
            } else {
                // Unknown QR code format
                closeQRScanner();
                showRealTimeNotification(`üì± QR Code scanned: ${qrCode.substring(0, 50)}${qrCode.length > 50 ? '...' : ''}`, 'info');
                
                // Try to process as order code anyway
                if (qrCode.length > 5) {
                    simulateQRScan(qrCode);
                }
            }
        }

        // Enhanced QR processing with camera feedback
        function simulateQRScan(qrCode) {
            const orderData = qrOrderDatabase[qrCode];
            
            if (orderData) {
                closeQRScanner();
                
                // Visual feedback for successful scan
                showRealTimeNotification('‚úÖ QR Code scanned successfully!', 'success');
                
                // Find the restaurant
                const restaurant = restaurants.find(r => r.name === orderData.restaurant);
                if (restaurant) {
                    currentRestaurant = restaurant;
                    
                    // Clear current cart and add items from QR
                    cart = [...orderData.items];
                    updateCartDisplay();
                    updateCartCount();
                    
                    showRealTimeNotification(`üéâ ${orderData.items.length} items added to cart from ${orderData.restaurant}`, 'success');
                    
                    // Show menu section
                    showRestaurantMenu(restaurant.id);
                    
                    // Auto-open cart after a delay
                    setTimeout(() => {
                        toggleCart();
                    }, 1500);
                } else {
                    showRealTimeNotification('‚ùå Restaurant not found for this QR code', 'error');
                }
            } else {
                showRealTimeNotification('‚ùå Invalid QR code. Please try again.', 'error');
            }
            
            // Clear manual input
            document.getElementById('manualQRInput').value = '';
        }

        // Enhanced manual QR processing
        function processManualQR() {
            const qrCode = document.getElementById('manualQRInput').value.trim().toUpperCase();
            
            if (!qrCode) {
                showRealTimeNotification('‚ö†Ô∏è Please enter a QR code', 'warning');
                return;
            }
            
            // Add visual feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Processing...';
            button.disabled = true;
            
            setTimeout(() => {
                simulateQRScan(qrCode);
                button.textContent = originalText;
                button.disabled = false;
            }, 1000);
        }

        // Enhanced order placement with QR generation
        function placeOrder() {
            const orderId = Date.now();
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal + 40; // delivery fee

            const order = {
                id: orderId,
                items: [...cart],
                restaurant: currentRestaurant.name,
                total: total,
                status: 'confirmed',
                timestamp: new Date(),
                estimatedDelivery: new Date(Date.now() + 30 * 60000) // 30 minutes
            };

            orders.unshift(order);
            
            // Create QR code data
            const qrOrderData = {
                restaurant: currentRestaurant.name,
                items: [...cart],
                total: total
            };
            
            // Award loyalty points for order
            const pointsEarned = Math.floor(total / 10); // 1 point per ‚Çπ10
            awardLoyaltyPoints(pointsEarned);
            
            // Update user preferences
            cart.forEach(item => {
                const existingFav = userPreferences.favoriteItems.find(fav => fav.id === item.id);
                if (existingFav) {
                    existingFav.orderCount++;
                } else {
                    userPreferences.favoriteItems.push({
                        id: item.id,
                        name: item.name,
                        restaurant: currentRestaurant.name,
                        orderCount: 1
                    });
                }
            });
            
            cart = [];
            
            updateCartDisplay();
            updateCartCount();
            closeModal('checkoutModal');
            
            // Show QR invoice instead of just notification
            setTimeout(() => {
                showQRInvoice(orderId, qrOrderData);
            }, 500);
            
            showRealTimeNotification(`üéâ Order placed successfully! You earned ${pointsEarned} points!`, 'success');
            
            // Start order tracking
            setTimeout(() => {
                simulateOrderProgressWithNotifications(orderId);
            }, 2000);
            
            // Update dashboard
            updatePersonalizedDashboard();
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e81e1b56c2551c',t:'MTc1Nzc3MTQ2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
